#!/usr/bin/env node
import { createRequire } from 'module';const require = createRequire(import.meta.url);
var Nl=Object.create;var rn=Object.defineProperty;var Ml=Object.getOwnPropertyDescriptor;var Tl=Object.getOwnPropertyNames;var Il=Object.getPrototypeOf,Dl=Object.prototype.hasOwnProperty;var v=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var y=(t,e)=>()=>(t&&(e=t(t=0)),e);var x=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),ze=(t,e)=>{for(var r in e)rn(t,r,{get:e[r],enumerable:!0})},Fl=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Tl(e))!Dl.call(t,i)&&i!==r&&rn(t,i,{get:()=>e[i],enumerable:!(n=Ml(e,i))||n.enumerable});return t};var A=(t,e,r)=>(r=t!=null?Nl(Il(t)):{},Fl(e||!t||!t.__esModule?rn(r,"default",{value:t,enumerable:!0}):r,t));var nt,Zt,er=y(()=>{nt=typeof globalThis.process<"u"?globalThis.process.argv:[],Zt=(t=nt[2])=>nt.filter(e=>!e.startsWith("--")).slice(nt.indexOf(t)+1)});var nn,Al,Mi,on=y(()=>{nn=()=>typeof globalThis.process<"u"?globalThis.process.env:{},Al=/\$([\w+]+)/gm,Mi=(t,e=nn(),r=Al)=>t.replace(r,(n,i)=>e[i]||n)});var $l,$,Rl,H,ug,bt,Ti,pe=y(()=>{er();on();$l=new Set(nt),$=t=>$l.has(t),Rl=nt.filter(t=>t.startsWith("--")&&t.includes("=")).map(t=>t.split("=")).reduce((t,[e,r])=>(t[e]=r,t),{}),H=t=>Rl[t],ug=$("--dry-run"),bt=()=>$("--verbose")||nn().VERBOSE==="true",Ti=bt()});var Te,Ii,Ie,fe,T,G,Bl,m,b=y(()=>{pe();Te=(t="",...e)=>console.log(t.padEnd(9),"|",...e),Ii=(...t)=>Te("",...t),Ie=(...t)=>Te("\u{1F7E2} DONE",...t),fe=(...t)=>console.error("\u{1F534} ERROR".padEnd(9),"|",...t),T=(...t)=>Te("\u{1F535} INFO",...t),G=(...t)=>Te("\u{1F7E0} WARN",...t),Bl=0,m=(...t)=>bt()&&Te(`\u{1F7E1} ${Bl++}`,...t)});import{kebabCase as jl}from"change-case";var De,Di,it=y(()=>{pe();De=()=>{let t=H("--src-path")||process.env.PLASMO_SRC_PATH||"src",e=H("--build-path")||process.env.PLASMO_BUILD_PATH||"build",r=H("--tag")||process.env.PLASMO_TAG||(process.env.NODE_ENV==="production"?"prod":"dev"),n=jl(H("--target")||process.env.PLASMO_TARGET||"chrome-mv3"),[i,o]=n.split("-"),s=H("--entry")||"popup",a=H("--env");return{browser:i,manifestVersion:o,tag:r,srcPath:t,buildPath:e,target:n,entry:s,envPath:a}},Di=`
    
    init

      --entry                     entry files (default: popup)
      --with-<name>               use an example template

    dev/build     

      --target [string]           set the target (default: chrome-mv3)
      --tag [string]              set the build tag (default: dev or prod depending on NODE_ENV)
      --src-path [path]           set the source path relative to project root (default: src)
      --build-path [path]         set the build path relative to project root (default: build)
      --entry                     entry point name (default: popup)
      --env                       relative path to top-level env file
`});var ue,tr,Ye=y(()=>{b();an();it();ue=()=>{console.log("\u{1F7E3} Plasmo v0.86.2"),console.log("\u{1F534} The Browser Extension Framework")},tr=()=>{Te("\u{1F7E0} CMDS",sn.join(" | ")),Te("\u{1F7E1} OPTS",Di)}});var Fi={};ze(Fi,{default:()=>ql});async function Ul(){ue(),tr()}var ql,Ai=y(()=>{Ye();ql=Ul});var $i={};ze($i,{default:()=>Vl});async function Wl(){T("Start the extension development...")}var Vl,Ri=y(()=>{b();Vl=Wl});import{constants as cn}from"fs";import{access as Hl,mkdir as Gl,readdir as Jl,stat as Bi}from"fs/promises";async function ln(t,e){try{return await Hl(t,e),!0}catch{return!1}}async function rr(t){return ln(t,cn.W_OK)}async function nr(t){return ln(t,cn.R_OK)}async function F(t){return ln(t,cn.F_OK)}async function ji(t){try{return(await Bi(t)).isDirectory()}catch{return!1}}async function ir(t){try{return(await Bi(t)).isFile()}catch{return!1}}async function Yl(t){let e=(await Jl(t,{withFileTypes:!0})).filter(r=>!zl.has(r.name)).filter(r=>!/\.iml$/.test(r.name));if(e.length>0){m(`Found conflicting contents in ${t}`);let r=e.reduce((n,i)=>`${n}
	${i.name}${i.isDirectory()?"/":""}`,"");return m(r),!1}return!0}async function Ui(t){if(!await rr(t))m("Directory does not exist, creating..."),await Gl(t);else{if(m("Directory exists, checking if it is empty..."),!await Yl(t))throw new Error(`Directory ${t} is not empty.`);if(m("Checking if directory is writable..."),!await rr(t))throw new Error(`Directory ${t} is not accesible.`)}}var zl,K=y(()=>{b();zl=new Set([".DS_Store",".git",".gitattributes",".gitignore",".gitlab-ci.yml",".hg",".hgcheck",".hgignore",".idea",".npmignore",".travis.yml","LICENSE","Thumbs.db","docs","mkdocs.yml","npm-debug.log","yarn-debug.log","yarn-error.log",".pnpm-debug.log"])});import{existsSync as Kl}from"fs";import{basename as Xl,resolve as oe}from"path";import{cwd as Ql}from"process";var ot,or=y(()=>{it();ot=(t=Ql())=>{let e=De();process.env.PLASMO_PROJECT_DIR=t;let r=Xl(t);process.env.PLASMO_SRC_PATH=e.srcPath;let n=oe(t,e.srcPath);process.env.PLASMO_SRC_DIR=Kl(n)?n:t,process.env.PLASMO_BUILD_PATH=e.buildPath;let i=oe(t,e.buildPath);process.env.PLASMO_BUILD_DIR=i;let o=`${e.target}-${e.tag}`,s=oe(i,o),a=oe(t,".plasmo"),c=oe(a,"cache");return{packageName:r,projectDirectory:t,buildDirectory:i,distDirectory:s,distDirectoryName:o,sourceDirectory:process.env.PLASMO_SRC_DIR,packageFilePath:oe(t,"package.json"),gitIgnorePath:oe(t,".gitignore"),assetsDirectory:oe(t,"assets"),parcelConfig:oe(t,".parcelrc"),dotPlasmoDirectory:a,cacheDirectory:c,plasmoVersionFilePath:oe(c,"plasmo.version.json"),staticDirectory:oe(a,"static"),genAssetsDirectory:oe(a,"gen-assets"),entryManifestPath:oe(a,`${e.target}.plasmo.manifest.json`)}}});import Zl from"@expo/spawn-async";import ef from"semver";async function fn(t){let e=await Zl(t,["--version"]),r=ef.valid(e.stdout.trim())||void 0;return{name:t,version:r}}async function st(){try{let t=process.env.npm_config_user_agent;if(t){if(t.startsWith("yarn"))return{name:"yarn"};if(t.startsWith("pnpm"))return{name:"pnpm"}}try{return await fn("pnpm")}catch{return await fn("yarn")}}catch{return await fn("npm")}}var sr=y(()=>{});var ee=x(un=>{"use strict";un.fromCallback=function(t){return Object.defineProperty(function(...e){if(typeof e[e.length-1]=="function")t.apply(this,e);else return new Promise((r,n)=>{t.call(this,...e,(i,o)=>i!=null?n(i):r(o))})},"name",{value:t.name})};un.fromPromise=function(t){return Object.defineProperty(function(...e){let r=e[e.length-1];if(typeof r!="function")return t.apply(this,e);t.apply(this,e.slice(0,-1)).then(n=>r(null,n),r)},"name",{value:t.name})}});var Wi=x(($g,qi)=>{var Fe=v("constants"),tf=process.cwd,ar=null,rf=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return ar||(ar=tf.call(process)),ar};try{process.cwd()}catch{}typeof process.chdir=="function"&&(pn=process.chdir,process.chdir=function(t){ar=null,pn.call(process,t)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,pn));var pn;qi.exports=nf;function nf(t){Fe.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&e(t),t.lutimes||r(t),t.chown=o(t.chown),t.fchown=o(t.fchown),t.lchown=o(t.lchown),t.chmod=n(t.chmod),t.fchmod=n(t.fchmod),t.lchmod=n(t.lchmod),t.chownSync=s(t.chownSync),t.fchownSync=s(t.fchownSync),t.lchownSync=s(t.lchownSync),t.chmodSync=i(t.chmodSync),t.fchmodSync=i(t.fchmodSync),t.lchmodSync=i(t.lchmodSync),t.stat=a(t.stat),t.fstat=a(t.fstat),t.lstat=a(t.lstat),t.statSync=c(t.statSync),t.fstatSync=c(t.fstatSync),t.lstatSync=c(t.lstatSync),t.chmod&&!t.lchmod&&(t.lchmod=function(l,u,p){p&&process.nextTick(p)},t.lchmodSync=function(){}),t.chown&&!t.lchown&&(t.lchown=function(l,u,p,d){d&&process.nextTick(d)},t.lchownSync=function(){}),rf==="win32"&&(t.rename=typeof t.rename!="function"?t.rename:function(l){function u(p,d,h){var g=Date.now(),_=0;l(p,d,function S(C){if(C&&(C.code==="EACCES"||C.code==="EPERM"||C.code==="EBUSY")&&Date.now()-g<6e4){setTimeout(function(){t.stat(d,function(O,W){O&&O.code==="ENOENT"?l(p,d,S):h(C)})},_),_<100&&(_+=10);return}h&&h(C)})}return Object.setPrototypeOf&&Object.setPrototypeOf(u,l),u}(t.rename)),t.read=typeof t.read!="function"?t.read:function(l){function u(p,d,h,g,_,S){var C;if(S&&typeof S=="function"){var O=0;C=function(W,Me,Pe){if(W&&W.code==="EAGAIN"&&O<10)return O++,l.call(t,p,d,h,g,_,C);S.apply(this,arguments)}}return l.call(t,p,d,h,g,_,C)}return Object.setPrototypeOf&&Object.setPrototypeOf(u,l),u}(t.read),t.readSync=typeof t.readSync!="function"?t.readSync:function(l){return function(u,p,d,h,g){for(var _=0;;)try{return l.call(t,u,p,d,h,g)}catch(S){if(S.code==="EAGAIN"&&_<10){_++;continue}throw S}}}(t.readSync);function e(l){l.lchmod=function(u,p,d){l.open(u,Fe.O_WRONLY|Fe.O_SYMLINK,p,function(h,g){if(h){d&&d(h);return}l.fchmod(g,p,function(_){l.close(g,function(S){d&&d(_||S)})})})},l.lchmodSync=function(u,p){var d=l.openSync(u,Fe.O_WRONLY|Fe.O_SYMLINK,p),h=!0,g;try{g=l.fchmodSync(d,p),h=!1}finally{if(h)try{l.closeSync(d)}catch{}else l.closeSync(d)}return g}}function r(l){Fe.hasOwnProperty("O_SYMLINK")&&l.futimes?(l.lutimes=function(u,p,d,h){l.open(u,Fe.O_SYMLINK,function(g,_){if(g){h&&h(g);return}l.futimes(_,p,d,function(S){l.close(_,function(C){h&&h(S||C)})})})},l.lutimesSync=function(u,p,d){var h=l.openSync(u,Fe.O_SYMLINK),g,_=!0;try{g=l.futimesSync(h,p,d),_=!1}finally{if(_)try{l.closeSync(h)}catch{}else l.closeSync(h)}return g}):l.futimes&&(l.lutimes=function(u,p,d,h){h&&process.nextTick(h)},l.lutimesSync=function(){})}function n(l){return l&&function(u,p,d){return l.call(t,u,p,function(h){f(h)&&(h=null),d&&d.apply(this,arguments)})}}function i(l){return l&&function(u,p){try{return l.call(t,u,p)}catch(d){if(!f(d))throw d}}}function o(l){return l&&function(u,p,d,h){return l.call(t,u,p,d,function(g){f(g)&&(g=null),h&&h.apply(this,arguments)})}}function s(l){return l&&function(u,p,d){try{return l.call(t,u,p,d)}catch(h){if(!f(h))throw h}}}function a(l){return l&&function(u,p,d){typeof p=="function"&&(d=p,p=null);function h(g,_){_&&(_.uid<0&&(_.uid+=4294967296),_.gid<0&&(_.gid+=4294967296)),d&&d.apply(this,arguments)}return p?l.call(t,u,p,h):l.call(t,u,h)}}function c(l){return l&&function(u,p){var d=p?l.call(t,u,p):l.call(t,u);return d&&(d.uid<0&&(d.uid+=4294967296),d.gid<0&&(d.gid+=4294967296)),d}}function f(l){if(!l||l.code==="ENOSYS")return!0;var u=!process.getuid||process.getuid()!==0;return!!(u&&(l.code==="EINVAL"||l.code==="EPERM"))}}});var Gi=x((Rg,Hi)=>{var Vi=v("stream").Stream;Hi.exports=of;function of(t){return{ReadStream:e,WriteStream:r};function e(n,i){if(!(this instanceof e))return new e(n,i);Vi.call(this);var o=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,i=i||{};for(var s=Object.keys(i),a=0,c=s.length;a<c;a++){var f=s[a];this[f]=i[f]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){o._read()});return}t.open(this.path,this.flags,this.mode,function(l,u){if(l){o.emit("error",l),o.readable=!1;return}o.fd=u,o.emit("open",u),o._read()})}function r(n,i){if(!(this instanceof r))return new r(n,i);Vi.call(this),this.path=n,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,i=i||{};for(var o=Object.keys(i),s=0,a=o.length;s<a;s++){var c=o[s];this[c]=i[c]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=t.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}});var zi=x((Bg,Ji)=>{"use strict";Ji.exports=af;var sf=Object.getPrototypeOf||function(t){return t.__proto__};function af(t){if(t===null||typeof t!="object")return t;if(t instanceof Object)var e={__proto__:sf(t)};else var e=Object.create(null);return Object.getOwnPropertyNames(t).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}});var te=x((jg,hn)=>{var D=v("fs"),cf=Wi(),lf=Gi(),ff=zi(),cr=v("util"),J,fr;typeof Symbol=="function"&&typeof Symbol.for=="function"?(J=Symbol.for("graceful-fs.queue"),fr=Symbol.for("graceful-fs.previous")):(J="___graceful-fs.queue",fr="___graceful-fs.previous");function uf(){}function Xi(t,e){Object.defineProperty(t,J,{get:function(){return e}})}var Ke=uf;cr.debuglog?Ke=cr.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(Ke=function(){var t=cr.format.apply(cr,arguments);t="GFS4: "+t.split(/\n/).join(`
GFS4: `),console.error(t)});D[J]||(Yi=global[J]||[],Xi(D,Yi),D.close=function(t){function e(r,n){return t.call(D,r,function(i){i||Ki(),typeof n=="function"&&n.apply(this,arguments)})}return Object.defineProperty(e,fr,{value:t}),e}(D.close),D.closeSync=function(t){function e(r){t.apply(D,arguments),Ki()}return Object.defineProperty(e,fr,{value:t}),e}(D.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){Ke(D[J]),v("assert").equal(D[J].length,0)}));var Yi;global[J]||Xi(global,D[J]);hn.exports=mn(ff(D));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!D.__patched&&(hn.exports=mn(D),D.__patched=!0);function mn(t){cf(t),t.gracefulify=mn,t.createReadStream=Me,t.createWriteStream=Pe;var e=t.readFile;t.readFile=r;function r(w,k,E){return typeof k=="function"&&(E=k,k=null),B(w,k,E);function B(j,P,L,N){return e(j,P,function(M){M&&(M.code==="EMFILE"||M.code==="ENFILE")?at([B,[j,P,L],M,N||Date.now(),Date.now()]):typeof L=="function"&&L.apply(this,arguments)})}}var n=t.writeFile;t.writeFile=i;function i(w,k,E,B){return typeof E=="function"&&(B=E,E=null),j(w,k,E,B);function j(P,L,N,M,V){return n(P,L,N,function(I){I&&(I.code==="EMFILE"||I.code==="ENFILE")?at([j,[P,L,N,M],I,V||Date.now(),Date.now()]):typeof M=="function"&&M.apply(this,arguments)})}}var o=t.appendFile;o&&(t.appendFile=s);function s(w,k,E,B){return typeof E=="function"&&(B=E,E=null),j(w,k,E,B);function j(P,L,N,M,V){return o(P,L,N,function(I){I&&(I.code==="EMFILE"||I.code==="ENFILE")?at([j,[P,L,N,M],I,V||Date.now(),Date.now()]):typeof M=="function"&&M.apply(this,arguments)})}}var a=t.copyFile;a&&(t.copyFile=c);function c(w,k,E,B){return typeof E=="function"&&(B=E,E=0),j(w,k,E,B);function j(P,L,N,M,V){return a(P,L,N,function(I){I&&(I.code==="EMFILE"||I.code==="ENFILE")?at([j,[P,L,N,M],I,V||Date.now(),Date.now()]):typeof M=="function"&&M.apply(this,arguments)})}}var f=t.readdir;t.readdir=u;var l=/^v[0-5]\./;function u(w,k,E){typeof k=="function"&&(E=k,k=null);var B=l.test(process.version)?function(L,N,M,V){return f(L,j(L,N,M,V))}:function(L,N,M,V){return f(L,N,j(L,N,M,V))};return B(w,k,E);function j(P,L,N,M){return function(V,I){V&&(V.code==="EMFILE"||V.code==="ENFILE")?at([B,[P,L,N],V,M||Date.now(),Date.now()]):(I&&I.sort&&I.sort(),typeof N=="function"&&N.call(this,V,I))}}}if(process.version.substr(0,4)==="v0.8"){var p=lf(t);S=p.ReadStream,O=p.WriteStream}var d=t.ReadStream;d&&(S.prototype=Object.create(d.prototype),S.prototype.open=C);var h=t.WriteStream;h&&(O.prototype=Object.create(h.prototype),O.prototype.open=W),Object.defineProperty(t,"ReadStream",{get:function(){return S},set:function(w){S=w},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WriteStream",{get:function(){return O},set:function(w){O=w},enumerable:!0,configurable:!0});var g=S;Object.defineProperty(t,"FileReadStream",{get:function(){return g},set:function(w){g=w},enumerable:!0,configurable:!0});var _=O;Object.defineProperty(t,"FileWriteStream",{get:function(){return _},set:function(w){_=w},enumerable:!0,configurable:!0});function S(w,k){return this instanceof S?(d.apply(this,arguments),this):S.apply(Object.create(S.prototype),arguments)}function C(){var w=this;xe(w.path,w.flags,w.mode,function(k,E){k?(w.autoClose&&w.destroy(),w.emit("error",k)):(w.fd=E,w.emit("open",E),w.read())})}function O(w,k){return this instanceof O?(h.apply(this,arguments),this):O.apply(Object.create(O.prototype),arguments)}function W(){var w=this;xe(w.path,w.flags,w.mode,function(k,E){k?(w.destroy(),w.emit("error",k)):(w.fd=E,w.emit("open",E))})}function Me(w,k){return new t.ReadStream(w,k)}function Pe(w,k){return new t.WriteStream(w,k)}var Je=t.open;t.open=xe;function xe(w,k,E,B){return typeof E=="function"&&(B=E,E=null),j(w,k,E,B);function j(P,L,N,M,V){return Je(P,L,N,function(I,ig){I&&(I.code==="EMFILE"||I.code==="ENFILE")?at([j,[P,L,N,M],I,V||Date.now(),Date.now()]):typeof M=="function"&&M.apply(this,arguments)})}}return t}function at(t){Ke("ENQUEUE",t[0].name,t[1]),D[J].push(t),dn()}var lr;function Ki(){for(var t=Date.now(),e=0;e<D[J].length;++e)D[J][e].length>2&&(D[J][e][3]=t,D[J][e][4]=t);dn()}function dn(){if(clearTimeout(lr),lr=void 0,D[J].length!==0){var t=D[J].shift(),e=t[0],r=t[1],n=t[2],i=t[3],o=t[4];if(i===void 0)Ke("RETRY",e.name,r),e.apply(null,r);else if(Date.now()-i>=6e4){Ke("TIMEOUT",e.name,r);var s=r.pop();typeof s=="function"&&s.call(null,n)}else{var a=Date.now()-o,c=Math.max(o-i,1),f=Math.min(c*1.2,100);a>=f?(Ke("RETRY",e.name,r),e.apply(null,r.concat([i]))):D[J].push(t)}lr===void 0&&(lr=setTimeout(dn,0))}}});var Xe=x(be=>{"use strict";var Qi=ee().fromCallback,X=te(),pf=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchmod","lchown","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter(t=>typeof X[t]=="function");Object.assign(be,X);pf.forEach(t=>{be[t]=Qi(X[t])});be.exists=function(t,e){return typeof e=="function"?X.exists(t,e):new Promise(r=>X.exists(t,r))};be.read=function(t,e,r,n,i,o){return typeof o=="function"?X.read(t,e,r,n,i,o):new Promise((s,a)=>{X.read(t,e,r,n,i,(c,f,l)=>{if(c)return a(c);s({bytesRead:f,buffer:l})})})};be.write=function(t,e,...r){return typeof r[r.length-1]=="function"?X.write(t,e,...r):new Promise((n,i)=>{X.write(t,e,...r,(o,s,a)=>{if(o)return i(o);n({bytesWritten:s,buffer:a})})})};be.readv=function(t,e,...r){return typeof r[r.length-1]=="function"?X.readv(t,e,...r):new Promise((n,i)=>{X.readv(t,e,...r,(o,s,a)=>{if(o)return i(o);n({bytesRead:s,buffers:a})})})};be.writev=function(t,e,...r){return typeof r[r.length-1]=="function"?X.writev(t,e,...r):new Promise((n,i)=>{X.writev(t,e,...r,(o,s,a)=>{if(o)return i(o);n({bytesWritten:s,buffers:a})})})};typeof X.realpath.native=="function"?be.realpath.native=Qi(X.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var eo=x((qg,Zi)=>{"use strict";var mf=v("path");Zi.exports.checkPath=function(e){if(process.platform==="win32"&&/[<>:"|?*]/.test(e.replace(mf.parse(e).root,""))){let n=new Error(`Path contains invalid characters: ${e}`);throw n.code="EINVAL",n}}});var io=x((Wg,gn)=>{"use strict";var to=Xe(),{checkPath:ro}=eo(),no=t=>{let e={mode:511};return typeof t=="number"?t:{...e,...t}.mode};gn.exports.makeDir=async(t,e)=>(ro(t),to.mkdir(t,{mode:no(e),recursive:!0}));gn.exports.makeDirSync=(t,e)=>(ro(t),to.mkdirSync(t,{mode:no(e),recursive:!0}))});var me=x((Vg,oo)=>{"use strict";var df=ee().fromPromise,{makeDir:hf,makeDirSync:yn}=io(),_n=df(hf);oo.exports={mkdirs:_n,mkdirsSync:yn,mkdirp:_n,mkdirpSync:yn,ensureDir:_n,ensureDirSync:yn}});var Ae=x((Hg,ao)=>{"use strict";var gf=ee().fromPromise,so=Xe();function yf(t){return so.access(t).then(()=>!0).catch(()=>!1)}ao.exports={pathExists:gf(yf),pathExistsSync:so.existsSync}});var wn=x((Gg,co)=>{"use strict";var ct=te();function _f(t,e,r,n){ct.open(t,"r+",(i,o)=>{if(i)return n(i);ct.futimes(o,e,r,s=>{ct.close(o,a=>{n&&n(s||a)})})})}function wf(t,e,r){let n=ct.openSync(t,"r+");return ct.futimesSync(n,e,r),ct.closeSync(n)}co.exports={utimesMillis:_f,utimesMillisSync:wf}});var Qe=x((Jg,uo)=>{"use strict";var lt=Xe(),U=v("path"),xf=v("util");function vf(t,e,r){let n=r.dereference?i=>lt.stat(i,{bigint:!0}):i=>lt.lstat(i,{bigint:!0});return Promise.all([n(t),n(e).catch(i=>{if(i.code==="ENOENT")return null;throw i})]).then(([i,o])=>({srcStat:i,destStat:o}))}function Sf(t,e,r){let n,i=r.dereference?s=>lt.statSync(s,{bigint:!0}):s=>lt.lstatSync(s,{bigint:!0}),o=i(t);try{n=i(e)}catch(s){if(s.code==="ENOENT")return{srcStat:o,destStat:null};throw s}return{srcStat:o,destStat:n}}function Ef(t,e,r,n,i){xf.callbackify(vf)(t,e,n,(o,s)=>{if(o)return i(o);let{srcStat:a,destStat:c}=s;if(c){if(kt(a,c)){let f=U.basename(t),l=U.basename(e);return r==="move"&&f!==l&&f.toLowerCase()===l.toLowerCase()?i(null,{srcStat:a,destStat:c,isChangingCase:!0}):i(new Error("Source and destination must not be the same."))}if(a.isDirectory()&&!c.isDirectory())return i(new Error(`Cannot overwrite non-directory '${e}' with directory '${t}'.`));if(!a.isDirectory()&&c.isDirectory())return i(new Error(`Cannot overwrite directory '${e}' with non-directory '${t}'.`))}return a.isDirectory()&&xn(t,e)?i(new Error(ur(t,e,r))):i(null,{srcStat:a,destStat:c})})}function Pf(t,e,r,n){let{srcStat:i,destStat:o}=Sf(t,e,n);if(o){if(kt(i,o)){let s=U.basename(t),a=U.basename(e);if(r==="move"&&s!==a&&s.toLowerCase()===a.toLowerCase())return{srcStat:i,destStat:o,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(i.isDirectory()&&!o.isDirectory())throw new Error(`Cannot overwrite non-directory '${e}' with directory '${t}'.`);if(!i.isDirectory()&&o.isDirectory())throw new Error(`Cannot overwrite directory '${e}' with non-directory '${t}'.`)}if(i.isDirectory()&&xn(t,e))throw new Error(ur(t,e,r));return{srcStat:i,destStat:o}}function lo(t,e,r,n,i){let o=U.resolve(U.dirname(t)),s=U.resolve(U.dirname(r));if(s===o||s===U.parse(s).root)return i();lt.stat(s,{bigint:!0},(a,c)=>a?a.code==="ENOENT"?i():i(a):kt(e,c)?i(new Error(ur(t,r,n))):lo(t,e,s,n,i))}function fo(t,e,r,n){let i=U.resolve(U.dirname(t)),o=U.resolve(U.dirname(r));if(o===i||o===U.parse(o).root)return;let s;try{s=lt.statSync(o,{bigint:!0})}catch(a){if(a.code==="ENOENT")return;throw a}if(kt(e,s))throw new Error(ur(t,r,n));return fo(t,e,o,n)}function kt(t,e){return e.ino&&e.dev&&e.ino===t.ino&&e.dev===t.dev}function xn(t,e){let r=U.resolve(t).split(U.sep).filter(i=>i),n=U.resolve(e).split(U.sep).filter(i=>i);return r.reduce((i,o,s)=>i&&n[s]===o,!0)}function ur(t,e,r){return`Cannot ${r} '${t}' to a subdirectory of itself, '${e}'.`}uo.exports={checkPaths:Ef,checkPathsSync:Pf,checkParentPaths:lo,checkParentPathsSync:fo,isSrcSubdir:xn,areIdentical:kt}});var _o=x((zg,yo)=>{"use strict";var re=te(),Ct=v("path"),bf=me().mkdirs,kf=Ae().pathExists,Cf=wn().utimesMillis,Ot=Qe();function Of(t,e,r,n){typeof r=="function"&&!n?(n=r,r={}):typeof r=="function"&&(r={filter:r}),n=n||function(){},r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001"),Ot.checkPaths(t,e,"copy",r,(i,o)=>{if(i)return n(i);let{srcStat:s,destStat:a}=o;Ot.checkParentPaths(t,s,e,"copy",c=>{if(c)return n(c);mo(t,e,r,(f,l)=>{if(f)return n(f);if(!l)return n();Lf(a,t,e,r,n)})})})}function Lf(t,e,r,n,i){let o=Ct.dirname(r);kf(o,(s,a)=>{if(s)return i(s);if(a)return vn(t,e,r,n,i);bf(o,c=>c?i(c):vn(t,e,r,n,i))})}function mo(t,e,r,n){if(!r.filter)return n(null,!0);Promise.resolve(r.filter(t,e)).then(i=>n(null,i),i=>n(i))}function vn(t,e,r,n,i){(n.dereference?re.stat:re.lstat)(e,(s,a)=>s?i(s):a.isDirectory()?Af(a,t,e,r,n,i):a.isFile()||a.isCharacterDevice()||a.isBlockDevice()?Nf(a,t,e,r,n,i):a.isSymbolicLink()?Bf(t,e,r,n,i):a.isSocket()?i(new Error(`Cannot copy a socket file: ${e}`)):a.isFIFO()?i(new Error(`Cannot copy a FIFO pipe: ${e}`)):i(new Error(`Unknown file: ${e}`)))}function Nf(t,e,r,n,i,o){return e?Mf(t,r,n,i,o):ho(t,r,n,i,o)}function Mf(t,e,r,n,i){if(n.overwrite)re.unlink(r,o=>o?i(o):ho(t,e,r,n,i));else return n.errorOnExist?i(new Error(`'${r}' already exists`)):i()}function ho(t,e,r,n,i){re.copyFile(e,r,o=>o?i(o):n.preserveTimestamps?Tf(t.mode,e,r,i):pr(r,t.mode,i))}function Tf(t,e,r,n){return If(t)?Df(r,t,i=>i?n(i):po(t,e,r,n)):po(t,e,r,n)}function If(t){return(t&128)===0}function Df(t,e,r){return pr(t,e|128,r)}function po(t,e,r,n){Ff(e,r,i=>i?n(i):pr(r,t,n))}function pr(t,e,r){return re.chmod(t,e,r)}function Ff(t,e,r){re.stat(t,(n,i)=>n?r(n):Cf(e,i.atime,i.mtime,r))}function Af(t,e,r,n,i,o){return e?go(r,n,i,o):$f(t.mode,r,n,i,o)}function $f(t,e,r,n,i){re.mkdir(r,o=>{if(o)return i(o);go(e,r,n,s=>s?i(s):pr(r,t,i))})}function go(t,e,r,n){re.readdir(t,(i,o)=>i?n(i):Sn(o,t,e,r,n))}function Sn(t,e,r,n,i){let o=t.pop();return o?Rf(t,o,e,r,n,i):i()}function Rf(t,e,r,n,i,o){let s=Ct.join(r,e),a=Ct.join(n,e);mo(s,a,i,(c,f)=>{if(c)return o(c);if(!f)return Sn(t,r,n,i,o);Ot.checkPaths(s,a,"copy",i,(l,u)=>{if(l)return o(l);let{destStat:p}=u;vn(p,s,a,i,d=>d?o(d):Sn(t,r,n,i,o))})})}function Bf(t,e,r,n,i){re.readlink(e,(o,s)=>{if(o)return i(o);if(n.dereference&&(s=Ct.resolve(process.cwd(),s)),t)re.readlink(r,(a,c)=>a?a.code==="EINVAL"||a.code==="UNKNOWN"?re.symlink(s,r,i):i(a):(n.dereference&&(c=Ct.resolve(process.cwd(),c)),Ot.isSrcSubdir(s,c)?i(new Error(`Cannot copy '${s}' to a subdirectory of itself, '${c}'.`)):Ot.isSrcSubdir(c,s)?i(new Error(`Cannot overwrite '${c}' with '${s}'.`)):jf(s,r,i)));else return re.symlink(s,r,i)})}function jf(t,e,r){re.unlink(e,n=>n?r(n):re.symlink(t,e,r))}yo.exports=Of});var Eo=x((Yg,So)=>{"use strict";var Q=te(),Lt=v("path"),Uf=me().mkdirsSync,qf=wn().utimesMillisSync,Nt=Qe();function Wf(t,e,r){typeof r=="function"&&(r={filter:r}),r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");let{srcStat:n,destStat:i}=Nt.checkPathsSync(t,e,"copy",r);if(Nt.checkParentPathsSync(t,n,e,"copy"),r.filter&&!r.filter(t,e))return;let o=Lt.dirname(e);return Q.existsSync(o)||Uf(o),wo(i,t,e,r)}function wo(t,e,r,n){let o=(n.dereference?Q.statSync:Q.lstatSync)(e);if(o.isDirectory())return Kf(o,t,e,r,n);if(o.isFile()||o.isCharacterDevice()||o.isBlockDevice())return Vf(o,t,e,r,n);if(o.isSymbolicLink())return Zf(t,e,r,n);throw o.isSocket()?new Error(`Cannot copy a socket file: ${e}`):o.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${e}`):new Error(`Unknown file: ${e}`)}function Vf(t,e,r,n,i){return e?Hf(t,r,n,i):xo(t,r,n,i)}function Hf(t,e,r,n){if(n.overwrite)return Q.unlinkSync(r),xo(t,e,r,n);if(n.errorOnExist)throw new Error(`'${r}' already exists`)}function xo(t,e,r,n){return Q.copyFileSync(e,r),n.preserveTimestamps&&Gf(t.mode,e,r),En(r,t.mode)}function Gf(t,e,r){return Jf(t)&&zf(r,t),Yf(e,r)}function Jf(t){return(t&128)===0}function zf(t,e){return En(t,e|128)}function En(t,e){return Q.chmodSync(t,e)}function Yf(t,e){let r=Q.statSync(t);return qf(e,r.atime,r.mtime)}function Kf(t,e,r,n,i){return e?vo(r,n,i):Xf(t.mode,r,n,i)}function Xf(t,e,r,n){return Q.mkdirSync(r),vo(e,r,n),En(r,t)}function vo(t,e,r){Q.readdirSync(t).forEach(n=>Qf(n,t,e,r))}function Qf(t,e,r,n){let i=Lt.join(e,t),o=Lt.join(r,t);if(n.filter&&!n.filter(i,o))return;let{destStat:s}=Nt.checkPathsSync(i,o,"copy",n);return wo(s,i,o,n)}function Zf(t,e,r,n){let i=Q.readlinkSync(e);if(n.dereference&&(i=Lt.resolve(process.cwd(),i)),t){let o;try{o=Q.readlinkSync(r)}catch(s){if(s.code==="EINVAL"||s.code==="UNKNOWN")return Q.symlinkSync(i,r);throw s}if(n.dereference&&(o=Lt.resolve(process.cwd(),o)),Nt.isSrcSubdir(i,o))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${o}'.`);if(Nt.isSrcSubdir(o,i))throw new Error(`Cannot overwrite '${o}' with '${i}'.`);return eu(i,r)}else return Q.symlinkSync(i,r)}function eu(t,e){return Q.unlinkSync(e),Q.symlinkSync(t,e)}So.exports=Wf});var mr=x((Kg,Po)=>{"use strict";var tu=ee().fromCallback;Po.exports={copy:tu(_o()),copySync:Eo()}});var Mt=x((Xg,ko)=>{"use strict";var bo=te(),ru=ee().fromCallback;function nu(t,e){bo.rm(t,{recursive:!0,force:!0},e)}function iu(t){bo.rmSync(t,{recursive:!0,force:!0})}ko.exports={remove:ru(nu),removeSync:iu}});var Do=x((Qg,Io)=>{"use strict";var ou=ee().fromPromise,Lo=Xe(),No=v("path"),Mo=me(),To=Mt(),Co=ou(async function(e){let r;try{r=await Lo.readdir(e)}catch{return Mo.mkdirs(e)}return Promise.all(r.map(n=>To.remove(No.join(e,n))))});function Oo(t){let e;try{e=Lo.readdirSync(t)}catch{return Mo.mkdirsSync(t)}e.forEach(r=>{r=No.join(t,r),To.removeSync(r)})}Io.exports={emptyDirSync:Oo,emptydirSync:Oo,emptyDir:Co,emptydir:Co}});var Ro=x((Zg,$o)=>{"use strict";var su=ee().fromCallback,Fo=v("path"),$e=te(),Ao=me();function au(t,e){function r(){$e.writeFile(t,"",n=>{if(n)return e(n);e()})}$e.stat(t,(n,i)=>{if(!n&&i.isFile())return e();let o=Fo.dirname(t);$e.stat(o,(s,a)=>{if(s)return s.code==="ENOENT"?Ao.mkdirs(o,c=>{if(c)return e(c);r()}):e(s);a.isDirectory()?r():$e.readdir(o,c=>{if(c)return e(c)})})})}function cu(t){let e;try{e=$e.statSync(t)}catch{}if(e&&e.isFile())return;let r=Fo.dirname(t);try{$e.statSync(r).isDirectory()||$e.readdirSync(r)}catch(n){if(n&&n.code==="ENOENT")Ao.mkdirsSync(r);else throw n}$e.writeFileSync(t,"")}$o.exports={createFile:su(au),createFileSync:cu}});var Wo=x((ey,qo)=>{"use strict";var lu=ee().fromCallback,Bo=v("path"),Re=te(),jo=me(),fu=Ae().pathExists,{areIdentical:Uo}=Qe();function uu(t,e,r){function n(i,o){Re.link(i,o,s=>{if(s)return r(s);r(null)})}Re.lstat(e,(i,o)=>{Re.lstat(t,(s,a)=>{if(s)return s.message=s.message.replace("lstat","ensureLink"),r(s);if(o&&Uo(a,o))return r(null);let c=Bo.dirname(e);fu(c,(f,l)=>{if(f)return r(f);if(l)return n(t,e);jo.mkdirs(c,u=>{if(u)return r(u);n(t,e)})})})})}function pu(t,e){let r;try{r=Re.lstatSync(e)}catch{}try{let o=Re.lstatSync(t);if(r&&Uo(o,r))return}catch(o){throw o.message=o.message.replace("lstat","ensureLink"),o}let n=Bo.dirname(e);return Re.existsSync(n)||jo.mkdirsSync(n),Re.linkSync(t,e)}qo.exports={createLink:lu(uu),createLinkSync:pu}});var Ho=x((ty,Vo)=>{"use strict";var Be=v("path"),Tt=te(),mu=Ae().pathExists;function du(t,e,r){if(Be.isAbsolute(t))return Tt.lstat(t,n=>n?(n.message=n.message.replace("lstat","ensureSymlink"),r(n)):r(null,{toCwd:t,toDst:t}));{let n=Be.dirname(e),i=Be.join(n,t);return mu(i,(o,s)=>o?r(o):s?r(null,{toCwd:i,toDst:t}):Tt.lstat(t,a=>a?(a.message=a.message.replace("lstat","ensureSymlink"),r(a)):r(null,{toCwd:t,toDst:Be.relative(n,t)})))}}function hu(t,e){let r;if(Be.isAbsolute(t)){if(r=Tt.existsSync(t),!r)throw new Error("absolute srcpath does not exist");return{toCwd:t,toDst:t}}else{let n=Be.dirname(e),i=Be.join(n,t);if(r=Tt.existsSync(i),r)return{toCwd:i,toDst:t};if(r=Tt.existsSync(t),!r)throw new Error("relative srcpath does not exist");return{toCwd:t,toDst:Be.relative(n,t)}}}Vo.exports={symlinkPaths:du,symlinkPathsSync:hu}});var zo=x((ry,Jo)=>{"use strict";var Go=te();function gu(t,e,r){if(r=typeof e=="function"?e:r,e=typeof e=="function"?!1:e,e)return r(null,e);Go.lstat(t,(n,i)=>{if(n)return r(null,"file");e=i&&i.isDirectory()?"dir":"file",r(null,e)})}function yu(t,e){let r;if(e)return e;try{r=Go.lstatSync(t)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}Jo.exports={symlinkType:gu,symlinkTypeSync:yu}});var rs=x((ny,ts)=>{"use strict";var _u=ee().fromCallback,Ko=v("path"),de=Xe(),Xo=me(),wu=Xo.mkdirs,xu=Xo.mkdirsSync,Qo=Ho(),vu=Qo.symlinkPaths,Su=Qo.symlinkPathsSync,Zo=zo(),Eu=Zo.symlinkType,Pu=Zo.symlinkTypeSync,bu=Ae().pathExists,{areIdentical:es}=Qe();function ku(t,e,r,n){n=typeof r=="function"?r:n,r=typeof r=="function"?!1:r,de.lstat(e,(i,o)=>{!i&&o.isSymbolicLink()?Promise.all([de.stat(t),de.stat(e)]).then(([s,a])=>{if(es(s,a))return n(null);Yo(t,e,r,n)}):Yo(t,e,r,n)})}function Yo(t,e,r,n){vu(t,e,(i,o)=>{if(i)return n(i);t=o.toDst,Eu(o.toCwd,r,(s,a)=>{if(s)return n(s);let c=Ko.dirname(e);bu(c,(f,l)=>{if(f)return n(f);if(l)return de.symlink(t,e,a,n);wu(c,u=>{if(u)return n(u);de.symlink(t,e,a,n)})})})})}function Cu(t,e,r){let n;try{n=de.lstatSync(e)}catch{}if(n&&n.isSymbolicLink()){let a=de.statSync(t),c=de.statSync(e);if(es(a,c))return}let i=Su(t,e);t=i.toDst,r=Pu(i.toCwd,r);let o=Ko.dirname(e);return de.existsSync(o)||xu(o),de.symlinkSync(t,e,r)}ts.exports={createSymlink:_u(ku),createSymlinkSync:Cu}});var fs=x((iy,ls)=>{"use strict";var{createFile:ns,createFileSync:is}=Ro(),{createLink:os,createLinkSync:ss}=Wo(),{createSymlink:as,createSymlinkSync:cs}=rs();ls.exports={createFile:ns,createFileSync:is,ensureFile:ns,ensureFileSync:is,createLink:os,createLinkSync:ss,ensureLink:os,ensureLinkSync:ss,createSymlink:as,createSymlinkSync:cs,ensureSymlink:as,ensureSymlinkSync:cs}});var dr=x((oy,us)=>{function Ou(t,{EOL:e=`
`,finalEOL:r=!0,replacer:n=null,spaces:i}={}){let o=r?e:"";return JSON.stringify(t,n,i).replace(/\n/g,e)+o}function Lu(t){return Buffer.isBuffer(t)&&(t=t.toString("utf8")),t.replace(/^\uFEFF/,"")}us.exports={stringify:Ou,stripBom:Lu}});var hs=x((sy,ds)=>{var ft;try{ft=te()}catch{ft=v("fs")}var hr=ee(),{stringify:ps,stripBom:ms}=dr();async function Nu(t,e={}){typeof e=="string"&&(e={encoding:e});let r=e.fs||ft,n="throws"in e?e.throws:!0,i=await hr.fromCallback(r.readFile)(t,e);i=ms(i);let o;try{o=JSON.parse(i,e?e.reviver:null)}catch(s){if(n)throw s.message=`${t}: ${s.message}`,s;return null}return o}var Mu=hr.fromPromise(Nu);function Tu(t,e={}){typeof e=="string"&&(e={encoding:e});let r=e.fs||ft,n="throws"in e?e.throws:!0;try{let i=r.readFileSync(t,e);return i=ms(i),JSON.parse(i,e.reviver)}catch(i){if(n)throw i.message=`${t}: ${i.message}`,i;return null}}async function Iu(t,e,r={}){let n=r.fs||ft,i=ps(e,r);await hr.fromCallback(n.writeFile)(t,i,r)}var Du=hr.fromPromise(Iu);function Fu(t,e,r={}){let n=r.fs||ft,i=ps(e,r);return n.writeFileSync(t,i,r)}var Au={readFile:Mu,readFileSync:Tu,writeFile:Du,writeFileSync:Fu};ds.exports=Au});var ys=x((ay,gs)=>{"use strict";var gr=hs();gs.exports={readJson:gr.readFile,readJsonSync:gr.readFileSync,writeJson:gr.writeFile,writeJsonSync:gr.writeFileSync}});var yr=x((cy,xs)=>{"use strict";var $u=ee().fromCallback,It=te(),_s=v("path"),ws=me(),Ru=Ae().pathExists;function Bu(t,e,r,n){typeof r=="function"&&(n=r,r="utf8");let i=_s.dirname(t);Ru(i,(o,s)=>{if(o)return n(o);if(s)return It.writeFile(t,e,r,n);ws.mkdirs(i,a=>{if(a)return n(a);It.writeFile(t,e,r,n)})})}function ju(t,...e){let r=_s.dirname(t);if(It.existsSync(r))return It.writeFileSync(t,...e);ws.mkdirsSync(r),It.writeFileSync(t,...e)}xs.exports={outputFile:$u(Bu),outputFileSync:ju}});var Ss=x((ly,vs)=>{"use strict";var{stringify:Uu}=dr(),{outputFile:qu}=yr();async function Wu(t,e,r={}){let n=Uu(e,r);await qu(t,n,r)}vs.exports=Wu});var Ps=x((fy,Es)=>{"use strict";var{stringify:Vu}=dr(),{outputFileSync:Hu}=yr();function Gu(t,e,r){let n=Vu(e,r);Hu(t,n,r)}Es.exports=Gu});var ks=x((uy,bs)=>{"use strict";var Ju=ee().fromPromise,Z=ys();Z.outputJson=Ju(Ss());Z.outputJsonSync=Ps();Z.outputJSON=Z.outputJson;Z.outputJSONSync=Z.outputJsonSync;Z.writeJSON=Z.writeJson;Z.writeJSONSync=Z.writeJsonSync;Z.readJSON=Z.readJson;Z.readJSONSync=Z.readJsonSync;bs.exports=Z});var Ms=x((py,Ns)=>{"use strict";var zu=te(),bn=v("path"),Yu=mr().copy,Ls=Mt().remove,Ku=me().mkdirp,Xu=Ae().pathExists,Cs=Qe();function Qu(t,e,r,n){typeof r=="function"&&(n=r,r={}),r=r||{};let i=r.overwrite||r.clobber||!1;Cs.checkPaths(t,e,"move",r,(o,s)=>{if(o)return n(o);let{srcStat:a,isChangingCase:c=!1}=s;Cs.checkParentPaths(t,a,e,"move",f=>{if(f)return n(f);if(Zu(e))return Os(t,e,i,c,n);Ku(bn.dirname(e),l=>l?n(l):Os(t,e,i,c,n))})})}function Zu(t){let e=bn.dirname(t);return bn.parse(e).root===e}function Os(t,e,r,n,i){if(n)return Pn(t,e,r,i);if(r)return Ls(e,o=>o?i(o):Pn(t,e,r,i));Xu(e,(o,s)=>o?i(o):s?i(new Error("dest already exists.")):Pn(t,e,r,i))}function Pn(t,e,r,n){zu.rename(t,e,i=>i?i.code!=="EXDEV"?n(i):ep(t,e,r,n):n())}function ep(t,e,r,n){Yu(t,e,{overwrite:r,errorOnExist:!0,preserveTimestamps:!0},o=>o?n(o):Ls(t,n))}Ns.exports=Qu});var As=x((my,Fs)=>{"use strict";var Is=te(),Cn=v("path"),tp=mr().copySync,Ds=Mt().removeSync,rp=me().mkdirpSync,Ts=Qe();function np(t,e,r){r=r||{};let n=r.overwrite||r.clobber||!1,{srcStat:i,isChangingCase:o=!1}=Ts.checkPathsSync(t,e,"move",r);return Ts.checkParentPathsSync(t,i,e,"move"),ip(e)||rp(Cn.dirname(e)),op(t,e,n,o)}function ip(t){let e=Cn.dirname(t);return Cn.parse(e).root===e}function op(t,e,r,n){if(n)return kn(t,e,r);if(r)return Ds(e),kn(t,e,r);if(Is.existsSync(e))throw new Error("dest already exists.");return kn(t,e,r)}function kn(t,e,r){try{Is.renameSync(t,e)}catch(n){if(n.code!=="EXDEV")throw n;return sp(t,e,r)}}function sp(t,e,r){return tp(t,e,{overwrite:r,errorOnExist:!0,preserveTimestamps:!0}),Ds(t)}Fs.exports=np});var Rs=x((dy,$s)=>{"use strict";var ap=ee().fromCallback;$s.exports={move:ap(Ms()),moveSync:As()}});var z=x((hy,Bs)=>{"use strict";Bs.exports={...Xe(),...mr(),...Do(),...fs(),...ks(),...me(),...Rs(),...yr(),...Ae(),...Mt()}});var js,Us=y(()=>{js=()=>`
# See https://help.github.com/articles/ignoring-files/ for more about ignoring files.

# dependencies
/node_modules
/.pnp
.pnp.js

# testing
/coverage

#cache
.turbo
.next
.vercel

# misc
.DS_Store
*.pem

# debug
npm-debug.log*
yarn-debug.log*
yarn-error.log*
.pnpm-debug.log*


# local env files
.env*

out/
build/
dist/

# plasmo - https://www.plasmo.com
.plasmo

# bpp - http://bpp.browser.market/
keys.json

# typescript
.tsbuildinfo
`});import{userInfo as cp}from"os";import{sentenceCase as lp}from"change-case";import fp from"package-json";var up,qs,On,Ln=y(()=>{up=async({name:t="plasmo-extension",version:e="0.0.1",packageManager:r={}})=>{let n={name:t,displayName:lp(t),version:e,description:"A basic Plasmo extension.",author:cp().username,packageManager:void 0,scripts:{dev:"plasmo dev",build:"plasmo build",package:"plasmo package"},dependencies:{plasmo:"workspace:*",react:"*","react-dom":"*"},devDependencies:{"@types/chrome":"*","@types/node":"*","@types/react":"*","@types/react-dom":"*",prettier:"*",typescript:"*"},manifest:{host_permissions:["https://*/*"]}};return!r||!r.version?delete n.packageManager:n.packageManager=`${r.name}@${r.version}`,n},qs=async t=>await up(t),On=async t=>{let e={};return await Promise.all(Object.entries(t).map(async([r,n])=>{if(r==="plasmo")e[r]="0.86.2";else if(n==="workspace:*")try{let i=await fp(r,{version:"latest"});e[r]=i.version}catch{e[r]=n}else e[r]=n})),e}});import{dirname as pp,resolve as ut}from"path";import{fileURLToPath as mp}from"url";var _r,Nn=y(()=>{_r=()=>{let t=pp(mp(import.meta.url)),e=ut(t,"..","templates"),r=ut(e,"static"),n=ut(v.resolve("@plasmohq/init"),".."),i=ut(n,"templates"),o=ut(n,"entries"),s=ut(n,"bpp.yml");return{templatePath:e,initTemplatePath:i,initEntryPath:o,staticTemplatePath:r,bppYaml:s}}});import dp from"inquirer";var pt,Mn=y(()=>{pt=async(t="",e="")=>{let{data:r}=await dp.prompt({name:"data",prefix:"\u{1F7E1}",message:t,default:e});return r}});import{readFile as hp}from"fs/promises";import{extname as gp}from"path";import{strFromU8 as yp,unzipSync as _p}from"fflate";async function wp(t,e,r){if(t.content_security_policy&&(m("Convert content_security_policy"),e.manifest.content_security_policy={extension_pages:t.content_security_policy}),t.web_accessible_resources&&(m("Convert web_accessible_resources"),e.manifest.web_accessible_resources=[{matches:["https://*/*"],resources:t.web_accessible_resources}]),t.permissions){m("Convert permissions"),e.manifest.permissions=[],e.manifest.host_permissions=[];for(let n of t.permissions)n.startsWith("http")||n==="<all_urls>"?e.manifest.host_permissions.push(n):e.manifest.permissions.push(n)}t.browser_action&&(m("Convert browser_action"),e.manifest.action={default_title:t.browser_action.default_title}),t.background&&m("Convert background")}async function xp(t,e,r){t.content_security_policy&&(m("Convert content_security_policy"),e.manifest.content_security_policy={...t.content_security_policy}),t.web_accessible_resources&&(m("Convert web_accessible_resources"),e.manifest.web_accessible_resources=[...t.web_accessible_resources]),t.permissions&&(m("Transfer permissions"),e.manifest.permissions=[...t.permissions]),t.host_permissions&&(m("Transfer host_permissions"),e.manifest.host_permissions=[...t.host_permissions]),t.action&&(m("Convert browser_action"),e.manifest.action={default_title:t.action.default_title}),t.background&&m("Convert background")}var Ws,Vs,Hs,Gs=y(()=>{Ws=A(z(),1);b();Ln();Vs=async t=>{let e={unzipped:{},isZip:!1,manifestData:{}},r=gp(t);if(r===".zip"){let n=await hp(t);e.unzipped=_p(n),e.isZip=!0,e.manifestData=JSON.parse(yp(e.unzipped["manifest.json"]))}else if(r===".json")e.manifestData=await(0,Ws.readJson)(t);else return null;return e},Hs=async(t,e,{manifestData:r})=>{let n=await qs({name:t.packageName,packageManager:e});switch(n.version=r.version,n.displayName=r.name,n.description=r.description,r?.author&&(n.author=r.author),r.homepage_url&&(n.homepage=r.homepage_url),r.version_name&&(n.manifest.version_name=r.version_name),r.browser_specific_settings&&(n.manifest.browser_specific_settings=r.browser_specific_settings),r.default_locale&&m("Convert locale"),r.options_ui&&m("Convert options_ui"),r.chrome_url_overrides&&m("Convert chrome_url_overrides"),r.icons&&m("Convert icons"),r.content_scripts&&m("Convert content_scripts"),r.manifest_version){case 2:await wp(r,n,t);break;case 3:await xp(r,n,t);break;default:throw new Error("Unknown manifest version")}return n}});import{existsSync as Js}from"fs";import{lstat as vp,readFile as Sp,writeFile as Ep}from"fs/promises";import{isAbsolute as Pp,join as bp,relative as kp,resolve as Dt}from"path";import Cp from"@expo/spawn-async";import{sentenceCase as Op}from"change-case";import Lp from"ignore";import{temporaryDirectory as Np}from"tempy";var he,Mp,wr,zs=y(()=>{he=A(z(),1);pe();K();b();Us();Ln();Nn();Mn();Gs();Mp=/(?:^--with-)(?:\w+-?)+(?:[^-]$)/,wr=class{constructor(e,r,n=!1){this.commonPath=e;this.packageManager=r;this.isExample=n}templatePath=_r();async create(){return await this.createFrom()||await this.createWith()||await this.createBlank()}async createFrom(){let e=H("--from");if(!e)return!1;let r=Pp(e)?e:Dt(e),n=await vp(r);return n.isFile()?await this.createFromManifest(r):n.isDirectory()?await this.createFromLocalTemplate(r):!1}async createFromLocalTemplate(e){let r=Lp().add(["node_modules",".git",".env*"]),n=bp(e,".gitignore");if(await F(n)){let s=await Sp(n,"utf-8");r.add(s)}await(0,he.copy)(e,this.commonPath.projectDirectory,{filter:s=>s===e||!r.ignores(kp(e,s))});let o=await(0,he.readJson)(this.commonPath.packageFilePath);return await this.outputPackageData(o),T(`Creating new project from ${e}`),!0}async createFromManifest(e){let r=await Vs(e);if(r===null)return!1;await this.copyBlankInitFiles();let n=await Hs(this.commonPath,this.packageManager,r);return await this.outputPackageData(n,{resolveWorkspaceRefs:!0}),!0}async createWith(){let e=process.argv.find(r=>Mp.test(r));return e===void 0?!1:this.createWithExample(e.substring(2))}async createWithExample(e){let r=Np();m(`Download examples to temporary directory: ${r}`);try{await Cp("git",["clone","--depth","1","https://github.com/PlasmoHQ/examples.git","."],{cwd:r,ignoreStdio:!0})}catch(o){if(o.errno==="ENOENT")throw new Error("Unable to clone example repo. `git` is not in PATH.")}let n=Dt(r,e);if(!Js(n))throw new Error(`Example ${e} not found. You may file an example request at: https://docs.plasmo.com/exp`);m("Copy example to project directory"),await Promise.all([(0,he.copy)(n,this.commonPath.projectDirectory),this.copyBppWorkflow()]);let i=await(0,he.readJson)(this.commonPath.packageFilePath);return await this.outputPackageData(i,{resolveWorkspaceRefs:!0}),T(`Creating new project ${e.split("-").join(" ")}`),!0}async createBlank(){return await this.createWithExample("with-popup"),!0}async outputPackageData(e,{resolveWorkspaceRefs:r=!1}={}){let{packageName:n,packageFilePath:i}=this.commonPath;if(e.name=n,e.displayName=Op(n),e.description=await pt("Extension description:",e.description),this.isExample)delete e.packageManager,e.contributors=[await pt("Contributor name:",e.author)],e.author="Plasmo Corp. <foss@plasmo.com>";else if(delete e.contributors,e.author=await pt("Author name:",e.author),r){m("Replace workspace refs with the latest package version from npm registry");let o=await Promise.all([On(e.dependencies),On(e.devDependencies)]);e.dependencies=o[0],e.devDependencies=o[1]}await(0,he.outputJson)(i,e,{spaces:2})}async copyBlankInitFiles(){let r=(H("--entry")||"popup").split(new RegExp(",|\\s")).flatMap(n=>[`${n}.ts`,`${n}.tsx`]).map(n=>[Dt(this.templatePath.initEntryPath,n),Dt(this.commonPath.projectDirectory,n)]).filter(([n])=>Js(n));m("Using the following entry files: ",r),await Promise.all([(0,he.copy)(this.templatePath.initTemplatePath,this.commonPath.projectDirectory),this.copyBppWorkflow(),Ep(this.commonPath.gitIgnorePath,js())]),await Promise.all(r.map(([n,i])=>(0,he.copy)(n,i)))}async copyBppWorkflow(){if(this.isExample||$("--no-bpp"))return;m("Copying BPP workflow...");let e=Dt(this.commonPath.projectDirectory,".github","workflows","submit.yml");return(0,he.copy)(this.templatePath.bppYaml,e)}}});import{createQuestId as Tp}from"mnemonic-id";var Ys,Ks=y(()=>{er();b();Mn();Ys=async()=>{let[t]=Zt("init");return t?(m("Using user-provided name:",t),t):(m("Prompting for the extension name"),await pt("Extension name:",Tp()))}});import xr from"@expo/spawn-async";async function Xs(t,e){if(!await F(t.gitIgnorePath))return!1;try{return await Ip(e)}catch(r){return G(r.message),!1}}var Ip,Qs=y(()=>{K();b();Ip=async t=>{let{default:e}=await import("chalk"),r={cwd:t,ignoreStdio:!0};try{return m("Checking if the root is a git repository"),await xr("git",["rev-parse","--is-inside-work-tree"],r),m(`${t} is a git repository, bailing ${e.bold("git init")}`),!1}catch(n){if(n.errno==="ENOENT")throw new Error("Unable to initialize git repo. `git` not in PATH.")}return T("Initializing git project..."),await xr("git",["init"],r),await xr("git",["add","--all"],r),await xr("git",["commit","-m","Created a new Plasmo extension"],r),m("Added all files to git and created the initial commit."),!0}});import Dp from"@expo/spawn-async";var Zs,ea=y(()=>{b();Zs=async(t,e)=>{try{T("Installing dependencies..."),await Dp(e.name,["install"],{cwd:t,stdio:"inherit"})}catch(r){G(r.message)}}});var ta,ra=y(()=>{b();ta=async(t,e,r,n)=>{let{default:i}=await import("chalk");Ie("Your extension is ready in: ",i.yellowBright(t),`

    To start hacking, run:

`,t===e?"":`      cd ${r.packageName}
`,`      ${n.name} ${n.name==="npm"?"run dev":"dev"}
`,`
    Visit https://docs.plasmo.com for documentation and more examples.`)}});var na={};ze(na,{default:()=>Bp});import{resolve as Fp}from"path";import{cwd as Ap}from"process";import{kebabCase as $p}from"change-case";async function Rp(){ue();let t=$("--exp"),e=await Ys(),r=Ap(),n=Fp(r,$p(e)||e);m("Project directory:",n);let i=ot(n);if(m("Package name:",i.packageName),t&&!i.packageName.startsWith("with-"))throw new Error("Example extensions must have the `with-` prefix");await Ui(n);let o=await st();m(`Using package manager: ${o.name} ${o?.version}`),await new wr(i,o,t).create(),await Zs(n,o),await Xs(i,n),await ta(n,r,i,o)}var Bp,ia=y(()=>{pe();K();b();or();sr();Ye();zs();Ks();Qs();ea();ra();Bp=Rp});var ca=x((E_,aa)=>{"use strict";var{Duplex:jp}=v("stream");function oa(t){t.emit("close")}function Up(){!this.destroyed&&this._writableState.finished&&this.destroy()}function sa(t){this.removeListener("error",sa),this.destroy(),this.listenerCount("error")===0&&this.emit("error",t)}function qp(t,e){let r=!0,n=new jp({...e,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return t.on("message",function(o,s){let a=!s&&n._readableState.objectMode?o.toString():o;n.push(a)||t.pause()}),t.once("error",function(o){n.destroyed||(r=!1,n.destroy(o))}),t.once("close",function(){n.destroyed||n.push(null)}),n._destroy=function(i,o){if(t.readyState===t.CLOSED){o(i),process.nextTick(oa,n);return}let s=!1;t.once("error",function(c){s=!0,o(c)}),t.once("close",function(){s||o(i),process.nextTick(oa,n)}),r&&t.terminate()},n._final=function(i){if(t.readyState===t.CONNECTING){t.once("open",function(){n._final(i)});return}t._socket!==null&&(t._socket._writableState.finished?(i(),n._readableState.endEmitted&&n.destroy()):(t._socket.once("finish",function(){i()}),t.close()))},n._read=function(){t.isPaused&&t.resume()},n._write=function(i,o,s){if(t.readyState===t.CONNECTING){t.once("open",function(){n._write(i,o,s)});return}t.send(i,s)},n.on("end",Up),n.on("error",sa),n}aa.exports=qp});var je=x((P_,la)=>{"use strict";la.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var Ft=x((b_,vr)=>{"use strict";var{EMPTY_BUFFER:Wp}=je(),Tn=Buffer[Symbol.species];function Vp(t,e){if(t.length===0)return Wp;if(t.length===1)return t[0];let r=Buffer.allocUnsafe(e),n=0;for(let i=0;i<t.length;i++){let o=t[i];r.set(o,n),n+=o.length}return n<e?new Tn(r.buffer,r.byteOffset,n):r}function fa(t,e,r,n,i){for(let o=0;o<i;o++)r[n+o]=t[o]^e[o&3]}function ua(t,e){for(let r=0;r<t.length;r++)t[r]^=e[r&3]}function Hp(t){return t.length===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.length)}function In(t){if(In.readOnly=!0,Buffer.isBuffer(t))return t;let e;return t instanceof ArrayBuffer?e=new Tn(t):ArrayBuffer.isView(t)?e=new Tn(t.buffer,t.byteOffset,t.byteLength):(e=Buffer.from(t),In.readOnly=!1),e}vr.exports={concat:Vp,mask:fa,toArrayBuffer:Hp,toBuffer:In,unmask:ua};if(!process.env.WS_NO_BUFFER_UTIL)try{let t=v("bufferutil");vr.exports.mask=function(e,r,n,i,o){o<48?fa(e,r,n,i,o):t.mask(e,r,n,i,o)},vr.exports.unmask=function(e,r){e.length<32?ua(e,r):t.unmask(e,r)}}catch{}});var da=x((k_,ma)=>{"use strict";var pa=Symbol("kDone"),Dn=Symbol("kRun"),Fn=class{constructor(e){this[pa]=()=>{this.pending--,this[Dn]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[Dn]()}[Dn](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[pa])}}};ma.exports=Fn});var Rt=x((C_,_a)=>{"use strict";var At=v("zlib"),ha=Ft(),Gp=da(),{kStatusCode:ga}=je(),Jp=Buffer[Symbol.species],zp=Buffer.from([0,0,255,255]),Pr=Symbol("permessage-deflate"),ke=Symbol("total-length"),$t=Symbol("callback"),Ue=Symbol("buffers"),Er=Symbol("error"),Sr,An=class{constructor(e,r,n){if(this._maxPayload=n|0,this._options=e||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!r,this._deflate=null,this._inflate=null,this.params=null,!Sr){let i=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;Sr=new Gp(i)}}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[$t];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let r=this._options,n=e.find(i=>!(r.serverNoContextTakeover===!1&&i.server_no_context_takeover||i.server_max_window_bits&&(r.serverMaxWindowBits===!1||typeof r.serverMaxWindowBits=="number"&&r.serverMaxWindowBits>i.server_max_window_bits)||typeof r.clientMaxWindowBits=="number"&&!i.client_max_window_bits));if(!n)throw new Error("None of the extension offers can be accepted");return r.serverNoContextTakeover&&(n.server_no_context_takeover=!0),r.clientNoContextTakeover&&(n.client_no_context_takeover=!0),typeof r.serverMaxWindowBits=="number"&&(n.server_max_window_bits=r.serverMaxWindowBits),typeof r.clientMaxWindowBits=="number"?n.client_max_window_bits=r.clientMaxWindowBits:(n.client_max_window_bits===!0||r.clientMaxWindowBits===!1)&&delete n.client_max_window_bits,n}acceptAsClient(e){let r=e[0];if(this._options.clientNoContextTakeover===!1&&r.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!r.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(r.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&r.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return r}normalizeParams(e){return e.forEach(r=>{Object.keys(r).forEach(n=>{let i=r[n];if(i.length>1)throw new Error(`Parameter "${n}" must have only a single value`);if(i=i[0],n==="client_max_window_bits"){if(i!==!0){let o=+i;if(!Number.isInteger(o)||o<8||o>15)throw new TypeError(`Invalid value for parameter "${n}": ${i}`);i=o}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${n}": ${i}`)}else if(n==="server_max_window_bits"){let o=+i;if(!Number.isInteger(o)||o<8||o>15)throw new TypeError(`Invalid value for parameter "${n}": ${i}`);i=o}else if(n==="client_no_context_takeover"||n==="server_no_context_takeover"){if(i!==!0)throw new TypeError(`Invalid value for parameter "${n}": ${i}`)}else throw new Error(`Unknown parameter "${n}"`);r[n]=i})}),e}decompress(e,r,n){Sr.add(i=>{this._decompress(e,r,(o,s)=>{i(),n(o,s)})})}compress(e,r,n){Sr.add(i=>{this._compress(e,r,(o,s)=>{i(),n(o,s)})})}_decompress(e,r,n){let i=this._isServer?"client":"server";if(!this._inflate){let o=`${i}_max_window_bits`,s=typeof this.params[o]!="number"?At.Z_DEFAULT_WINDOWBITS:this.params[o];this._inflate=At.createInflateRaw({...this._options.zlibInflateOptions,windowBits:s}),this._inflate[Pr]=this,this._inflate[ke]=0,this._inflate[Ue]=[],this._inflate.on("error",Kp),this._inflate.on("data",ya)}this._inflate[$t]=n,this._inflate.write(e),r&&this._inflate.write(zp),this._inflate.flush(()=>{let o=this._inflate[Er];if(o){this._inflate.close(),this._inflate=null,n(o);return}let s=ha.concat(this._inflate[Ue],this._inflate[ke]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[ke]=0,this._inflate[Ue]=[],r&&this.params[`${i}_no_context_takeover`]&&this._inflate.reset()),n(null,s)})}_compress(e,r,n){let i=this._isServer?"server":"client";if(!this._deflate){let o=`${i}_max_window_bits`,s=typeof this.params[o]!="number"?At.Z_DEFAULT_WINDOWBITS:this.params[o];this._deflate=At.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:s}),this._deflate[ke]=0,this._deflate[Ue]=[],this._deflate.on("data",Yp)}this._deflate[$t]=n,this._deflate.write(e),this._deflate.flush(At.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let o=ha.concat(this._deflate[Ue],this._deflate[ke]);r&&(o=new Jp(o.buffer,o.byteOffset,o.length-4)),this._deflate[$t]=null,this._deflate[ke]=0,this._deflate[Ue]=[],r&&this.params[`${i}_no_context_takeover`]&&this._deflate.reset(),n(null,o)})}};_a.exports=An;function Yp(t){this[Ue].push(t),this[ke]+=t.length}function ya(t){if(this[ke]+=t.length,this[Pr]._maxPayload<1||this[ke]<=this[Pr]._maxPayload){this[Ue].push(t);return}this[Er]=new RangeError("Max payload size exceeded"),this[Er].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[Er][ga]=1009,this.removeListener("data",ya),this.reset()}function Kp(t){this[Pr]._inflate=null,t[ga]=1007,this[$t](t)}});var Bt=x((O_,br)=>{"use strict";var{isUtf8:wa}=v("buffer"),Xp=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function Qp(t){return t>=1e3&&t<=1014&&t!==1004&&t!==1005&&t!==1006||t>=3e3&&t<=4999}function $n(t){let e=t.length,r=0;for(;r<e;)if(!(t[r]&128))r++;else if((t[r]&224)===192){if(r+1===e||(t[r+1]&192)!==128||(t[r]&254)===192)return!1;r+=2}else if((t[r]&240)===224){if(r+2>=e||(t[r+1]&192)!==128||(t[r+2]&192)!==128||t[r]===224&&(t[r+1]&224)===128||t[r]===237&&(t[r+1]&224)===160)return!1;r+=3}else if((t[r]&248)===240){if(r+3>=e||(t[r+1]&192)!==128||(t[r+2]&192)!==128||(t[r+3]&192)!==128||t[r]===240&&(t[r+1]&240)===128||t[r]===244&&t[r+1]>143||t[r]>244)return!1;r+=4}else return!1;return!0}br.exports={isValidStatusCode:Qp,isValidUTF8:$n,tokenChars:Xp};if(wa)br.exports.isValidUTF8=function(t){return t.length<24?$n(t):wa(t)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let t=v("utf-8-validate");br.exports.isValidUTF8=function(e){return e.length<32?$n(e):t(e)}}catch{}});var qn=x((L_,Ca)=>{"use strict";var{Writable:Zp}=v("stream"),xa=Rt(),{BINARY_TYPES:em,EMPTY_BUFFER:va,kStatusCode:tm,kWebSocket:rm}=je(),{concat:Rn,toArrayBuffer:nm,unmask:im}=Ft(),{isValidStatusCode:om,isValidUTF8:Sa}=Bt(),kr=Buffer[Symbol.species],sm=Promise.resolve(),am=typeof queueMicrotask=="function"?queueMicrotask:cm,mt=0,Ea=1,Pa=2,ba=3,Bn=4,ka=5,jn=6,Un=class extends Zp{constructor(e={}){super(),this._binaryType=e.binaryType||em[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=e.maxPayload|0,this._skipUTF8Validation=!!e.skipUTF8Validation,this[rm]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._state=mt,this._loop=!1}_write(e,r,n){if(this._opcode===8&&this._state==mt)return n();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(n)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let n=this._buffers[0];return this._buffers[0]=new kr(n.buffer,n.byteOffset+e,n.length-e),new kr(n.buffer,n.byteOffset,e)}let r=Buffer.allocUnsafe(e);do{let n=this._buffers[0],i=r.length-e;e>=n.length?r.set(this._buffers.shift(),i):(r.set(new Uint8Array(n.buffer,n.byteOffset,e),i),this._buffers[0]=new kr(n.buffer,n.byteOffset+e,n.length-e)),e-=n.length}while(e>0);return r}startLoop(e){let r;this._loop=!0;do switch(this._state){case mt:r=this.getInfo();break;case Ea:r=this.getPayloadLength16();break;case Pa:r=this.getPayloadLength64();break;case ba:this.getMask();break;case Bn:r=this.getData(e);break;case ka:this._loop=!1;return;default:this._loop=!1,am(()=>{this._state=mt,this.startLoop(e)});return}while(this._loop);e(r)}getInfo(){if(this._bufferedBytes<2){this._loop=!1;return}let e=this.consume(2);if(e[0]&48)return this._loop=!1,q(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");let r=(e[0]&64)===64;if(r&&!this._extensions[xa.extensionName])return this._loop=!1,q(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._fin=(e[0]&128)===128,this._opcode=e[0]&15,this._payloadLength=e[1]&127,this._opcode===0){if(r)return this._loop=!1,q(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(!this._fragmented)return this._loop=!1,q(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented)return this._loop=!1,q(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");this._compressed=r}else if(this._opcode>7&&this._opcode<11){if(!this._fin)return this._loop=!1,q(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");if(r)return this._loop=!1,q(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1)return this._loop=!1,q(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH")}else return this._loop=!1,q(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(e[1]&128)===128,this._isServer){if(!this._masked)return this._loop=!1,q(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK")}else if(this._masked)return this._loop=!1,q(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");if(this._payloadLength===126)this._state=Ea;else if(this._payloadLength===127)this._state=Pa;else return this.haveLength()}getPayloadLength16(){if(this._bufferedBytes<2){this._loop=!1;return}return this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength()}getPayloadLength64(){if(this._bufferedBytes<8){this._loop=!1;return}let e=this.consume(8),r=e.readUInt32BE(0);return r>Math.pow(2,53-32)-1?(this._loop=!1,q(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH")):(this._payloadLength=r*Math.pow(2,32)+e.readUInt32BE(4),this.haveLength())}haveLength(){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return this._loop=!1,q(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");this._masked?this._state=ba:this._state=Bn}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=Bn}getData(e){let r=va;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}r=this.consume(this._payloadLength),this._masked&&this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3]&&im(r,this._mask)}if(this._opcode>7)return this.controlMessage(r);if(this._compressed){this._state=ka,this.decompress(r,e);return}return r.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(r)),this.dataMessage()}decompress(e,r){this._extensions[xa.extensionName].decompress(e,this._fin,(i,o)=>{if(i)return r(i);if(o.length){if(this._messageLength+=o.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return r(q(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(o)}let s=this.dataMessage();if(s)return r(s);this.startLoop(r)})}dataMessage(){if(this._fin){let e=this._messageLength,r=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let n;this._binaryType==="nodebuffer"?n=Rn(r,e):this._binaryType==="arraybuffer"?n=nm(Rn(r,e)):n=r,this.emit("message",n,!0)}else{let n=Rn(r,e);if(!this._skipUTF8Validation&&!Sa(n))return this._loop=!1,q(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("message",n,!1)}}this._state=jn}controlMessage(e){if(this._opcode===8)if(this._loop=!1,e.length===0)this.emit("conclude",1005,va),this.end(),this._state=mt;else{let r=e.readUInt16BE(0);if(!om(r))return q(RangeError,`invalid status code ${r}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");let n=new kr(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!Sa(n))return q(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");this.emit("conclude",r,n),this.end(),this._state=mt}else this._opcode===9?(this.emit("ping",e),this._state=jn):(this.emit("pong",e),this._state=jn)}};Ca.exports=Un;function q(t,e,r,n,i){let o=new t(r?`Invalid WebSocket frame: ${e}`:e);return Error.captureStackTrace(o,q),o.code=i,o[tm]=n,o}function cm(t){sm.then(t).catch(fm)}function lm(t){throw t}function fm(t){process.nextTick(lm,t)}});var Vn=x((M_,Na)=>{"use strict";var{Duplex:N_}=v("stream"),{randomFillSync:um}=v("crypto"),Oa=Rt(),{EMPTY_BUFFER:pm}=je(),{isValidStatusCode:mm}=Bt(),{mask:La,toBuffer:dt}=Ft(),ge=Symbol("kByteLength"),dm=Buffer.alloc(4),Wn=class t{constructor(e,r,n){this._extensions=r||{},n&&(this._generateMask=n,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,r){let n,i=!1,o=2,s=!1;r.mask&&(n=r.maskBuffer||dm,r.generateMask?r.generateMask(n):um(n,0,4),s=(n[0]|n[1]|n[2]|n[3])===0,o=6);let a;typeof e=="string"?(!r.mask||s)&&r[ge]!==void 0?a=r[ge]:(e=Buffer.from(e),a=e.length):(a=e.length,i=r.mask&&r.readOnly&&!s);let c=a;a>=65536?(o+=8,c=127):a>125&&(o+=2,c=126);let f=Buffer.allocUnsafe(i?a+o:o);return f[0]=r.fin?r.opcode|128:r.opcode,r.rsv1&&(f[0]|=64),f[1]=c,c===126?f.writeUInt16BE(a,2):c===127&&(f[2]=f[3]=0,f.writeUIntBE(a,4,6)),r.mask?(f[1]|=128,f[o-4]=n[0],f[o-3]=n[1],f[o-2]=n[2],f[o-1]=n[3],s?[f,e]:i?(La(e,n,f,o,a),[f]):(La(e,n,e,0,a),[f,e])):[f,e]}close(e,r,n,i){let o;if(e===void 0)o=pm;else{if(typeof e!="number"||!mm(e))throw new TypeError("First argument must be a valid error code number");if(r===void 0||!r.length)o=Buffer.allocUnsafe(2),o.writeUInt16BE(e,0);else{let a=Buffer.byteLength(r);if(a>123)throw new RangeError("The message must not be greater than 123 bytes");o=Buffer.allocUnsafe(2+a),o.writeUInt16BE(e,0),typeof r=="string"?o.write(r,2):o.set(r,2)}}let s={[ge]:o.length,fin:!0,generateMask:this._generateMask,mask:n,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,o,!1,s,i]):this.sendFrame(t.frame(o,s),i)}ping(e,r,n){let i,o;if(typeof e=="string"?(i=Buffer.byteLength(e),o=!1):(e=dt(e),i=e.length,o=dt.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");let s={[ge]:i,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:9,readOnly:o,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,s,n]):this.sendFrame(t.frame(e,s),n)}pong(e,r,n){let i,o;if(typeof e=="string"?(i=Buffer.byteLength(e),o=!1):(e=dt(e),i=e.length,o=dt.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");let s={[ge]:i,fin:!0,generateMask:this._generateMask,mask:r,maskBuffer:this._maskBuffer,opcode:10,readOnly:o,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,s,n]):this.sendFrame(t.frame(e,s),n)}send(e,r,n){let i=this._extensions[Oa.extensionName],o=r.binary?2:1,s=r.compress,a,c;if(typeof e=="string"?(a=Buffer.byteLength(e),c=!1):(e=dt(e),a=e.length,c=dt.readOnly),this._firstFragment?(this._firstFragment=!1,s&&i&&i.params[i._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(s=a>=i._threshold),this._compress=s):(s=!1,o=0),r.fin&&(this._firstFragment=!0),i){let f={[ge]:a,fin:r.fin,generateMask:this._generateMask,mask:r.mask,maskBuffer:this._maskBuffer,opcode:o,readOnly:c,rsv1:s};this._deflating?this.enqueue([this.dispatch,e,this._compress,f,n]):this.dispatch(e,this._compress,f,n)}else this.sendFrame(t.frame(e,{[ge]:a,fin:r.fin,generateMask:this._generateMask,mask:r.mask,maskBuffer:this._maskBuffer,opcode:o,readOnly:c,rsv1:!1}),n)}dispatch(e,r,n,i){if(!r){this.sendFrame(t.frame(e,n),i);return}let o=this._extensions[Oa.extensionName];this._bufferedBytes+=n[ge],this._deflating=!0,o.compress(e,n.fin,(s,a)=>{if(this._socket.destroyed){let c=new Error("The socket was closed while data was being compressed");typeof i=="function"&&i(c);for(let f=0;f<this._queue.length;f++){let l=this._queue[f],u=l[l.length-1];typeof u=="function"&&u(c)}return}this._bufferedBytes-=n[ge],this._deflating=!1,n.readOnly=!1,this.sendFrame(t.frame(a,n),i),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][ge],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][ge],this._queue.push(e)}sendFrame(e,r){e.length===2?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],r),this._socket.uncork()):this._socket.write(e[0],r)}};Na.exports=Wn});var Ba=x((T_,Ra)=>{"use strict";var{kForOnEventAttribute:jt,kListener:Hn}=je(),Ma=Symbol("kCode"),Ta=Symbol("kData"),Ia=Symbol("kError"),Da=Symbol("kMessage"),Fa=Symbol("kReason"),ht=Symbol("kTarget"),Aa=Symbol("kType"),$a=Symbol("kWasClean"),Ce=class{constructor(e){this[ht]=null,this[Aa]=e}get target(){return this[ht]}get type(){return this[Aa]}};Object.defineProperty(Ce.prototype,"target",{enumerable:!0});Object.defineProperty(Ce.prototype,"type",{enumerable:!0});var Ze=class extends Ce{constructor(e,r={}){super(e),this[Ma]=r.code===void 0?0:r.code,this[Fa]=r.reason===void 0?"":r.reason,this[$a]=r.wasClean===void 0?!1:r.wasClean}get code(){return this[Ma]}get reason(){return this[Fa]}get wasClean(){return this[$a]}};Object.defineProperty(Ze.prototype,"code",{enumerable:!0});Object.defineProperty(Ze.prototype,"reason",{enumerable:!0});Object.defineProperty(Ze.prototype,"wasClean",{enumerable:!0});var gt=class extends Ce{constructor(e,r={}){super(e),this[Ia]=r.error===void 0?null:r.error,this[Da]=r.message===void 0?"":r.message}get error(){return this[Ia]}get message(){return this[Da]}};Object.defineProperty(gt.prototype,"error",{enumerable:!0});Object.defineProperty(gt.prototype,"message",{enumerable:!0});var Ut=class extends Ce{constructor(e,r={}){super(e),this[Ta]=r.data===void 0?null:r.data}get data(){return this[Ta]}};Object.defineProperty(Ut.prototype,"data",{enumerable:!0});var hm={addEventListener(t,e,r={}){for(let i of this.listeners(t))if(!r[jt]&&i[Hn]===e&&!i[jt])return;let n;if(t==="message")n=function(o,s){let a=new Ut("message",{data:s?o:o.toString()});a[ht]=this,Cr(e,this,a)};else if(t==="close")n=function(o,s){let a=new Ze("close",{code:o,reason:s.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});a[ht]=this,Cr(e,this,a)};else if(t==="error")n=function(o){let s=new gt("error",{error:o,message:o.message});s[ht]=this,Cr(e,this,s)};else if(t==="open")n=function(){let o=new Ce("open");o[ht]=this,Cr(e,this,o)};else return;n[jt]=!!r[jt],n[Hn]=e,r.once?this.once(t,n):this.on(t,n)},removeEventListener(t,e){for(let r of this.listeners(t))if(r[Hn]===e&&!r[jt]){this.removeListener(t,r);break}}};Ra.exports={CloseEvent:Ze,ErrorEvent:gt,Event:Ce,EventTarget:hm,MessageEvent:Ut};function Cr(t,e,r){typeof t=="object"&&t.handleEvent?t.handleEvent.call(t,r):t.call(e,r)}});var Gn=x((I_,ja)=>{"use strict";var{tokenChars:qt}=Bt();function ve(t,e,r){t[e]===void 0?t[e]=[r]:t[e].push(r)}function gm(t){let e=Object.create(null),r=Object.create(null),n=!1,i=!1,o=!1,s,a,c=-1,f=-1,l=-1,u=0;for(;u<t.length;u++)if(f=t.charCodeAt(u),s===void 0)if(l===-1&&qt[f]===1)c===-1&&(c=u);else if(u!==0&&(f===32||f===9))l===-1&&c!==-1&&(l=u);else if(f===59||f===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${u}`);l===-1&&(l=u);let d=t.slice(c,l);f===44?(ve(e,d,r),r=Object.create(null)):s=d,c=l=-1}else throw new SyntaxError(`Unexpected character at index ${u}`);else if(a===void 0)if(l===-1&&qt[f]===1)c===-1&&(c=u);else if(f===32||f===9)l===-1&&c!==-1&&(l=u);else if(f===59||f===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${u}`);l===-1&&(l=u),ve(r,t.slice(c,l),!0),f===44&&(ve(e,s,r),r=Object.create(null),s=void 0),c=l=-1}else if(f===61&&c!==-1&&l===-1)a=t.slice(c,u),c=l=-1;else throw new SyntaxError(`Unexpected character at index ${u}`);else if(i){if(qt[f]!==1)throw new SyntaxError(`Unexpected character at index ${u}`);c===-1?c=u:n||(n=!0),i=!1}else if(o)if(qt[f]===1)c===-1&&(c=u);else if(f===34&&c!==-1)o=!1,l=u;else if(f===92)i=!0;else throw new SyntaxError(`Unexpected character at index ${u}`);else if(f===34&&t.charCodeAt(u-1)===61)o=!0;else if(l===-1&&qt[f]===1)c===-1&&(c=u);else if(c!==-1&&(f===32||f===9))l===-1&&(l=u);else if(f===59||f===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${u}`);l===-1&&(l=u);let d=t.slice(c,l);n&&(d=d.replace(/\\/g,""),n=!1),ve(r,a,d),f===44&&(ve(e,s,r),r=Object.create(null),s=void 0),a=void 0,c=l=-1}else throw new SyntaxError(`Unexpected character at index ${u}`);if(c===-1||o||f===32||f===9)throw new SyntaxError("Unexpected end of input");l===-1&&(l=u);let p=t.slice(c,l);return s===void 0?ve(e,p,r):(a===void 0?ve(r,p,!0):n?ve(r,a,p.replace(/\\/g,"")):ve(r,a,p),ve(e,s,r)),e}function ym(t){return Object.keys(t).map(e=>{let r=t[e];return Array.isArray(r)||(r=[r]),r.map(n=>[e].concat(Object.keys(n).map(i=>{let o=n[i];return Array.isArray(o)||(o=[o]),o.map(s=>s===!0?i:`${i}=${s}`).join("; ")})).join("; ")).join(", ")}).join(", ")}ja.exports={format:ym,parse:gm}});var Xn=x((A_,Xa)=>{"use strict";var _m=v("events"),wm=v("https"),xm=v("http"),Wa=v("net"),vm=v("tls"),{randomBytes:Sm,createHash:Em}=v("crypto"),{Duplex:D_,Readable:F_}=v("stream"),{URL:Jn}=v("url"),qe=Rt(),Pm=qn(),bm=Vn(),{BINARY_TYPES:Ua,EMPTY_BUFFER:Or,GUID:km,kForOnEventAttribute:zn,kListener:Cm,kStatusCode:Om,kWebSocket:Y,NOOP:Va}=je(),{EventTarget:{addEventListener:Lm,removeEventListener:Nm}}=Ba(),{format:Mm,parse:Tm}=Gn(),{toBuffer:Im}=Ft(),Dm=30*1e3,Ha=Symbol("kAborted"),Yn=[8,13],Oe=["CONNECTING","OPEN","CLOSING","CLOSED"],Fm=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,R=class t extends _m{constructor(e,r,n){super(),this._binaryType=Ua[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=Or,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=t.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,e!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,r===void 0?r=[]:Array.isArray(r)||(typeof r=="object"&&r!==null?(n=r,r=[]):r=[r]),Ga(this,e,r,n)):this._isServer=!0}get binaryType(){return this._binaryType}set binaryType(e){Ua.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,r,n){let i=new Pm({binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation});this._sender=new bm(e,this._extensions,n.generateMask),this._receiver=i,this._socket=e,i[Y]=this,e[Y]=this,i.on("conclude",Rm),i.on("drain",Bm),i.on("error",jm),i.on("message",Um),i.on("ping",qm),i.on("pong",Wm),e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),r.length>0&&e.unshift(r),e.on("close",za),e.on("data",Nr),e.on("end",Ya),e.on("error",Ka),this._readyState=t.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=t.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[qe.extensionName]&&this._extensions[qe.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=t.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,r){if(this.readyState!==t.CLOSED){if(this.readyState===t.CONNECTING){let n="WebSocket was closed before the connection was established";se(this,this._req,n);return}if(this.readyState===t.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=t.CLOSING,this._sender.close(e,r,!this._isServer,n=>{n||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),Dm)}}pause(){this.readyState===t.CONNECTING||this.readyState===t.CLOSED||(this._paused=!0,this._socket.pause())}ping(e,r,n){if(this.readyState===t.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(n=e,e=r=void 0):typeof r=="function"&&(n=r,r=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==t.OPEN){Kn(this,e,n);return}r===void 0&&(r=!this._isServer),this._sender.ping(e||Or,r,n)}pong(e,r,n){if(this.readyState===t.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(n=e,e=r=void 0):typeof r=="function"&&(n=r,r=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==t.OPEN){Kn(this,e,n);return}r===void 0&&(r=!this._isServer),this._sender.pong(e||Or,r,n)}resume(){this.readyState===t.CONNECTING||this.readyState===t.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,r,n){if(this.readyState===t.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof r=="function"&&(n=r,r={}),typeof e=="number"&&(e=e.toString()),this.readyState!==t.OPEN){Kn(this,e,n);return}let i={binary:typeof e!="string",mask:!this._isServer,compress:!0,fin:!0,...r};this._extensions[qe.extensionName]||(i.compress=!1),this._sender.send(e||Or,i,n)}terminate(){if(this.readyState!==t.CLOSED){if(this.readyState===t.CONNECTING){let e="WebSocket was closed before the connection was established";se(this,this._req,e);return}this._socket&&(this._readyState=t.CLOSING,this._socket.destroy())}}};Object.defineProperty(R,"CONNECTING",{enumerable:!0,value:Oe.indexOf("CONNECTING")});Object.defineProperty(R.prototype,"CONNECTING",{enumerable:!0,value:Oe.indexOf("CONNECTING")});Object.defineProperty(R,"OPEN",{enumerable:!0,value:Oe.indexOf("OPEN")});Object.defineProperty(R.prototype,"OPEN",{enumerable:!0,value:Oe.indexOf("OPEN")});Object.defineProperty(R,"CLOSING",{enumerable:!0,value:Oe.indexOf("CLOSING")});Object.defineProperty(R.prototype,"CLOSING",{enumerable:!0,value:Oe.indexOf("CLOSING")});Object.defineProperty(R,"CLOSED",{enumerable:!0,value:Oe.indexOf("CLOSED")});Object.defineProperty(R.prototype,"CLOSED",{enumerable:!0,value:Oe.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(t=>{Object.defineProperty(R.prototype,t,{enumerable:!0})});["open","error","close","message"].forEach(t=>{Object.defineProperty(R.prototype,`on${t}`,{enumerable:!0,get(){for(let e of this.listeners(t))if(e[zn])return e[Cm];return null},set(e){for(let r of this.listeners(t))if(r[zn]){this.removeListener(t,r);break}typeof e=="function"&&this.addEventListener(t,e,{[zn]:!0})}})});R.prototype.addEventListener=Lm;R.prototype.removeEventListener=Nm;Xa.exports=R;function Ga(t,e,r,n){let i={protocolVersion:Yn[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...n,createConnection:void 0,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(!Yn.includes(i.protocolVersion))throw new RangeError(`Unsupported protocol version: ${i.protocolVersion} (supported versions: ${Yn.join(", ")})`);let o;if(e instanceof Jn)o=e;else try{o=new Jn(e)}catch{throw new SyntaxError(`Invalid URL: ${e}`)}o.protocol==="http:"?o.protocol="ws:":o.protocol==="https:"&&(o.protocol="wss:"),t._url=o.href;let s=o.protocol==="wss:",a=o.protocol==="ws+unix:",c;if(o.protocol!=="ws:"&&!s&&!a?c=`The URL's protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"`:a&&!o.pathname?c="The URL's pathname is empty":o.hash&&(c="The URL contains a fragment identifier"),c){let g=new SyntaxError(c);if(t._redirects===0)throw g;Lr(t,g);return}let f=s?443:80,l=Sm(16).toString("base64"),u=s?wm.request:xm.request,p=new Set,d;if(i.createConnection=s?$m:Am,i.defaultPort=i.defaultPort||f,i.port=o.port||f,i.host=o.hostname.startsWith("[")?o.hostname.slice(1,-1):o.hostname,i.headers={...i.headers,"Sec-WebSocket-Version":i.protocolVersion,"Sec-WebSocket-Key":l,Connection:"Upgrade",Upgrade:"websocket"},i.path=o.pathname+o.search,i.timeout=i.handshakeTimeout,i.perMessageDeflate&&(d=new qe(i.perMessageDeflate!==!0?i.perMessageDeflate:{},!1,i.maxPayload),i.headers["Sec-WebSocket-Extensions"]=Mm({[qe.extensionName]:d.offer()})),r.length){for(let g of r){if(typeof g!="string"||!Fm.test(g)||p.has(g))throw new SyntaxError("An invalid or duplicated subprotocol was specified");p.add(g)}i.headers["Sec-WebSocket-Protocol"]=r.join(",")}if(i.origin&&(i.protocolVersion<13?i.headers["Sec-WebSocket-Origin"]=i.origin:i.headers.Origin=i.origin),(o.username||o.password)&&(i.auth=`${o.username}:${o.password}`),a){let g=i.path.split(":");i.socketPath=g[0],i.path=g[1]}let h;if(i.followRedirects){if(t._redirects===0){t._originalIpc=a,t._originalSecure=s,t._originalHostOrSocketPath=a?i.socketPath:o.host;let g=n&&n.headers;if(n={...n,headers:{}},g)for(let[_,S]of Object.entries(g))n.headers[_.toLowerCase()]=S}else if(t.listenerCount("redirect")===0){let g=a?t._originalIpc?i.socketPath===t._originalHostOrSocketPath:!1:t._originalIpc?!1:o.host===t._originalHostOrSocketPath;(!g||t._originalSecure&&!s)&&(delete i.headers.authorization,delete i.headers.cookie,g||delete i.headers.host,i.auth=void 0)}i.auth&&!n.headers.authorization&&(n.headers.authorization="Basic "+Buffer.from(i.auth).toString("base64")),h=t._req=u(i),t._redirects&&t.emit("redirect",t.url,h)}else h=t._req=u(i);i.timeout&&h.on("timeout",()=>{se(t,h,"Opening handshake has timed out")}),h.on("error",g=>{h===null||h[Ha]||(h=t._req=null,Lr(t,g))}),h.on("response",g=>{let _=g.headers.location,S=g.statusCode;if(_&&i.followRedirects&&S>=300&&S<400){if(++t._redirects>i.maxRedirects){se(t,h,"Maximum redirects exceeded");return}h.abort();let C;try{C=new Jn(_,e)}catch{let W=new SyntaxError(`Invalid URL: ${_}`);Lr(t,W);return}Ga(t,C,r,n)}else t.emit("unexpected-response",h,g)||se(t,h,`Unexpected server response: ${g.statusCode}`)}),h.on("upgrade",(g,_,S)=>{if(t.emit("upgrade",g),t.readyState!==R.CONNECTING)return;if(h=t._req=null,g.headers.upgrade.toLowerCase()!=="websocket"){se(t,_,"Invalid Upgrade header");return}let C=Em("sha1").update(l+km).digest("base64");if(g.headers["sec-websocket-accept"]!==C){se(t,_,"Invalid Sec-WebSocket-Accept header");return}let O=g.headers["sec-websocket-protocol"],W;if(O!==void 0?p.size?p.has(O)||(W="Server sent an invalid subprotocol"):W="Server sent a subprotocol but none was requested":p.size&&(W="Server sent no subprotocol"),W){se(t,_,W);return}O&&(t._protocol=O);let Me=g.headers["sec-websocket-extensions"];if(Me!==void 0){if(!d){se(t,_,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let Pe;try{Pe=Tm(Me)}catch{se(t,_,"Invalid Sec-WebSocket-Extensions header");return}let Je=Object.keys(Pe);if(Je.length!==1||Je[0]!==qe.extensionName){se(t,_,"Server indicated an extension that was not requested");return}try{d.accept(Pe[qe.extensionName])}catch{se(t,_,"Invalid Sec-WebSocket-Extensions header");return}t._extensions[qe.extensionName]=d}t.setSocket(_,S,{generateMask:i.generateMask,maxPayload:i.maxPayload,skipUTF8Validation:i.skipUTF8Validation})}),i.finishRequest?i.finishRequest(h,t):h.end()}function Lr(t,e){t._readyState=R.CLOSING,t.emit("error",e),t.emitClose()}function Am(t){return t.path=t.socketPath,Wa.connect(t)}function $m(t){return t.path=void 0,!t.servername&&t.servername!==""&&(t.servername=Wa.isIP(t.host)?"":t.host),vm.connect(t)}function se(t,e,r){t._readyState=R.CLOSING;let n=new Error(r);Error.captureStackTrace(n,se),e.setHeader?(e[Ha]=!0,e.abort(),e.socket&&!e.socket.destroyed&&e.socket.destroy(),process.nextTick(Lr,t,n)):(e.destroy(n),e.once("error",t.emit.bind(t,"error")),e.once("close",t.emitClose.bind(t)))}function Kn(t,e,r){if(e){let n=Im(e).length;t._socket?t._sender._bufferedBytes+=n:t._bufferedAmount+=n}if(r){let n=new Error(`WebSocket is not open: readyState ${t.readyState} (${Oe[t.readyState]})`);process.nextTick(r,n)}}function Rm(t,e){let r=this[Y];r._closeFrameReceived=!0,r._closeMessage=e,r._closeCode=t,r._socket[Y]!==void 0&&(r._socket.removeListener("data",Nr),process.nextTick(Ja,r._socket),t===1005?r.close():r.close(t,e))}function Bm(){let t=this[Y];t.isPaused||t._socket.resume()}function jm(t){let e=this[Y];e._socket[Y]!==void 0&&(e._socket.removeListener("data",Nr),process.nextTick(Ja,e._socket),e.close(t[Om])),e.emit("error",t)}function qa(){this[Y].emitClose()}function Um(t,e){this[Y].emit("message",t,e)}function qm(t){let e=this[Y];e.pong(t,!e._isServer,Va),e.emit("ping",t)}function Wm(t){this[Y].emit("pong",t)}function Ja(t){t.resume()}function za(){let t=this[Y];this.removeListener("close",za),this.removeListener("data",Nr),this.removeListener("end",Ya),t._readyState=R.CLOSING;let e;!this._readableState.endEmitted&&!t._closeFrameReceived&&!t._receiver._writableState.errorEmitted&&(e=t._socket.read())!==null&&t._receiver.write(e),t._receiver.end(),this[Y]=void 0,clearTimeout(t._closeTimer),t._receiver._writableState.finished||t._receiver._writableState.errorEmitted?t.emitClose():(t._receiver.on("error",qa),t._receiver.on("finish",qa))}function Nr(t){this[Y]._receiver.write(t)||this.pause()}function Ya(){let t=this[Y];t._readyState=R.CLOSING,t._receiver.end(),this.end()}function Ka(){let t=this[Y];this.removeListener("error",Ka),this.on("error",Va),t&&(t._readyState=R.CLOSING,this.destroy())}});var Za=x(($_,Qa)=>{"use strict";var{tokenChars:Vm}=Bt();function Hm(t){let e=new Set,r=-1,n=-1,i=0;for(i;i<t.length;i++){let s=t.charCodeAt(i);if(n===-1&&Vm[s]===1)r===-1&&(r=i);else if(i!==0&&(s===32||s===9))n===-1&&r!==-1&&(n=i);else if(s===44){if(r===-1)throw new SyntaxError(`Unexpected character at index ${i}`);n===-1&&(n=i);let a=t.slice(r,n);if(e.has(a))throw new SyntaxError(`The "${a}" subprotocol is duplicated`);e.add(a),r=n=-1}else throw new SyntaxError(`Unexpected character at index ${i}`)}if(r===-1||n!==-1)throw new SyntaxError("Unexpected end of input");let o=t.slice(r,i);if(e.has(o))throw new SyntaxError(`The "${o}" subprotocol is duplicated`);return e.add(o),e}Qa.exports={parse:Hm}});var sc=x((B_,oc)=>{"use strict";var Gm=v("events"),Mr=v("http"),{Duplex:R_}=v("stream"),{createHash:Jm}=v("crypto"),ec=Gn(),et=Rt(),zm=Za(),Ym=Xn(),{GUID:Km,kWebSocket:Xm}=je(),Qm=/^[+/0-9A-Za-z]{22}==$/,tc=0,rc=1,ic=2,Qn=class extends Gm{constructor(e,r){if(super(),e={maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:Ym,...e},e.port==null&&!e.server&&!e.noServer||e.port!=null&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(e.port!=null?(this._server=Mr.createServer((n,i)=>{let o=Mr.STATUS_CODES[426];i.writeHead(426,{"Content-Length":o.length,"Content-Type":"text/plain"}),i.end(o)}),this._server.listen(e.port,e.host,e.backlog,r)):e.server&&(this._server=e.server),this._server){let n=this.emit.bind(this,"connection");this._removeListeners=Zm(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(i,o,s)=>{this.handleUpgrade(i,o,s,n)}})}e.perMessageDeflate===!0&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=tc}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(this._state===ic){e&&this.once("close",()=>{e(new Error("The server is not running"))}),process.nextTick(Wt,this);return}if(e&&this.once("close",e),this._state!==rc)if(this._state=rc,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(Wt,this):process.nextTick(Wt,this);else{let r=this._server;this._removeListeners(),this._removeListeners=this._server=null,r.close(()=>{Wt(this)})}}shouldHandle(e){if(this.options.path){let r=e.url.indexOf("?");if((r!==-1?e.url.slice(0,r):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,r,n,i){r.on("error",nc);let o=e.headers["sec-websocket-key"],s=+e.headers["sec-websocket-version"];if(e.method!=="GET"){tt(this,e,r,405,"Invalid HTTP method");return}if(e.headers.upgrade.toLowerCase()!=="websocket"){tt(this,e,r,400,"Invalid Upgrade header");return}if(!o||!Qm.test(o)){tt(this,e,r,400,"Missing or invalid Sec-WebSocket-Key header");return}if(s!==8&&s!==13){tt(this,e,r,400,"Missing or invalid Sec-WebSocket-Version header");return}if(!this.shouldHandle(e)){Vt(r,400);return}let a=e.headers["sec-websocket-protocol"],c=new Set;if(a!==void 0)try{c=zm.parse(a)}catch{tt(this,e,r,400,"Invalid Sec-WebSocket-Protocol header");return}let f=e.headers["sec-websocket-extensions"],l={};if(this.options.perMessageDeflate&&f!==void 0){let u=new et(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let p=ec.parse(f);p[et.extensionName]&&(u.accept(p[et.extensionName]),l[et.extensionName]=u)}catch{tt(this,e,r,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let u={origin:e.headers[`${s===8?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(this.options.verifyClient.length===2){this.options.verifyClient(u,(p,d,h,g)=>{if(!p)return Vt(r,d||401,h,g);this.completeUpgrade(l,o,c,e,r,n,i)});return}if(!this.options.verifyClient(u))return Vt(r,401)}this.completeUpgrade(l,o,c,e,r,n,i)}completeUpgrade(e,r,n,i,o,s,a){if(!o.readable||!o.writable)return o.destroy();if(o[Xm])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>tc)return Vt(o,503);let f=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${Jm("sha1").update(r+Km).digest("base64")}`],l=new this.options.WebSocket(null);if(n.size){let u=this.options.handleProtocols?this.options.handleProtocols(n,i):n.values().next().value;u&&(f.push(`Sec-WebSocket-Protocol: ${u}`),l._protocol=u)}if(e[et.extensionName]){let u=e[et.extensionName].params,p=ec.format({[et.extensionName]:[u]});f.push(`Sec-WebSocket-Extensions: ${p}`),l._extensions=e}this.emit("headers",f,i),o.write(f.concat(`\r
`).join(`\r
`)),o.removeListener("error",nc),l.setSocket(o,s,{maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(l),l.on("close",()=>{this.clients.delete(l),this._shouldEmitClose&&!this.clients.size&&process.nextTick(Wt,this)})),a(l,i)}};oc.exports=Qn;function Zm(t,e){for(let r of Object.keys(e))t.on(r,e[r]);return function(){for(let n of Object.keys(e))t.removeListener(n,e[n])}}function Wt(t){t._state=ic,t.emit("close")}function nc(){this.destroy()}function Vt(t,e,r,n){r=r||Mr.STATUS_CODES[e],n={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(r),...n},t.once("finish",t.destroy),t.end(`HTTP/1.1 ${e} ${Mr.STATUS_CODES[e]}\r
`+Object.keys(n).map(i=>`${i}: ${n[i]}`).join(`\r
`)+`\r
\r
`+r)}function tt(t,e,r,n,i){if(t.listenerCount("wsClientError")){let o=new Error(i);Error.captureStackTrace(o,tt),t.emit("wsClientError",o,r,e)}else Vt(r,n,i)}});var ed,td,rd,Zn,ei,ac=y(()=>{ed=A(ca(),1),td=A(qn(),1),rd=A(Vn(),1),Zn=A(Xn(),1),ei=A(sc(),1)});var cc=y(()=>{});var nd,Tr,ti,fc,ri=y(()=>{ac();cc();nd=(t,e)=>{let r=new ei.default({host:t,port:e+1});return{broadcast:i=>{for(let o of r.clients)o.readyState===Zn.default.OPEN&&o.send(JSON.stringify({type:i}))}}},ti=(t="localhost",e)=>{if(process.env.NODE_ENV==="production")return null;if(Tr)return Tr;if(!e)throw new Error("HMR port is not provided");return Tr=nd(t,e),Tr},fc=t=>{if(process.env.NODE_ENV==="production")return;let e=ti();e&&e.broadcast(t)}});var yt,Ir=y(()=>{it();yt=()=>{let t=De(),{target:e,tag:r}=t,[n,i]=e.split("-");return{tag:r,target:e,browser:n,manifestVersion:i}}});import{AssertionError as id}from"assert";function _t(t){throw new Error("Statement should be unreachable")}function ni(t,e="Value is invalid"){if(!t)throw new id({message:e});return t}var Ht=y(()=>{});function fd(t){switch(t){case 0:return"Web";case 1:case 2:case 3:return dc[t];default:_t(t)}}var oi,Fr,si,Gt,od,sd,uc,ad,cd,ld,ii,ai,Ve,He,ae,pc,mc,K_,dc,Dr,X_,Q_,hc,gc,Z_,Se,We,ud,ew,pd,tw,rw,nw,iw,yc=y(()=>{Ht();oi="en",Fr=!1,si=!1,Gt=!1,od=!1,sd=!1,uc=!1,ad=!1,cd=!1,ld=!1,ai=oi,He=typeof self=="object"?self:typeof global=="object"?global:{};typeof He.vscode<"u"&&typeof He.vscode.process<"u"?ae=He.vscode.process:typeof process<"u"&&(ae=process);pc=typeof ae?.versions?.electron=="string",mc=pc&&ae?.type==="renderer",K_=mc&&ae?.sandboxed;typeof navigator=="object"&&!mc?(Ve=navigator.userAgent,Fr=Ve.indexOf("Windows")>=0,si=Ve.indexOf("Macintosh")>=0,cd=(Ve.indexOf("Macintosh")>=0||Ve.indexOf("iPad")>=0||Ve.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,Gt=Ve.indexOf("Linux")>=0,uc=!0,ii=navigator.language,ai=ii):typeof ae=="object"?(Fr=ae.platform==="win32",si=ae.platform==="darwin",Gt=ae.platform==="linux",od=Gt&&!!ae.env.SNAP&&!!ae.env.SNAP_REVISION,ad=pc,ld=!!ae.env.CI||!!ae.env.BUILD_ARTIFACTSTAGINGDIRECTORY,ii=oi,ai=oi,sd=!0):console.error("Unable to resolve platform.");dc={1:"Mac",2:"Linux",3:"Windows"};Dr=0;si?Dr=1:Fr?Dr=3:Gt&&(Dr=2);X_=Object.values(dc),Q_=fd(Dr),hc=Fr,gc=Gt,Z_=uc&&typeof He.importScripts=="function",Se=Ve,We=ai;(n=>{function t(){return We}n.value=t;function e(){return We.length===2?We==="en":We.length>=3?We[0]==="e"&&We[1]==="n"&&We[2]==="-":!1}n.isDefaultVariant=e;function r(){return We==="en"}n.isDefault=r})(ud||={});ew=(()=>{if(typeof He.postMessage=="function"&&!He.importScripts){let t=[];He.addEventListener("message",r=>{if(r.data&&r.data.vscodeScheduleAsyncWork)for(let n=0,i=t.length;n<i;n++){let o=t[n];if(o.id===r.data.vscodeScheduleAsyncWork){t.splice(n,1),o.callback();return}}});let e=0;return r=>{let n=++e;t.push({id:n,callback:r}),He.postMessage({vscodeScheduleAsyncWork:n},"*")}}return t=>setTimeout(t)})(),pd=!!(Se&&Se.indexOf("Chrome")>=0),tw=!!(Se&&Se.indexOf("Firefox")>=0),rw=!!(!pd&&Se&&Se.indexOf("Safari")>=0),nw=!!(Se&&Se.indexOf("Edg/")>=0),iw=!!(Se&&Se.indexOf("Android")>=0)});var _c,wc=y(()=>{yc();_c=hc?"windows":gc?"inotify":"fs-events"});async function Le(t,e){for(let r of t)if(await e(r))return r}var Jt=y(()=>{});import{basename as md,extname as xc,posix as dd,win32 as hd}from"path";var ce,vc,wt=y(()=>{ce=t=>t.replaceAll(hd.sep,dd.sep),vc=t=>xc(md(t,xc(t)))});import{readFile as gd}from"fs/promises";import{resolve as yd}from"path";import{constantCase as _d}from"change-case";import wd from"dotenv";import{expand as xd}from"dotenv-expand";function Sd(t){let e=Object.assign({},process.env);for(let{contents:r,name:n}of t)try{Ec.add(n);let i=xd({ignoreProcessEnv:!0,parsed:wd.parse(r)});if(i.parsed){m(`Loaded env from ${n}`);let o=i.parsed||{};for(let[s,a]of Object.entries(o))if(typeof e[s]>"u"){try{e[s]=Pd(a)}catch(c){fe(`Failed to parse JSON directive ${s} in ${n}:`,c.message)}s.startsWith(Sc)&&(process.env[s]=a)}}}catch(i){fe(`Failed to load env from ${n}`,i)}return e}function Pd(t){let e=t.match(Ed);return e?JSON.parse(e[1]):t}async function Pc(t){let e=await Promise.all(li().map(o=>[o,yd(t,o)]).map(async([o,s])=>[o,s,await ir(s)&&await nr(s)])),r=await Promise.all(e.filter(([,,o])=>o).map(async([o,s])=>({name:o,contents:await gd(s,"utf8")}))),n=Sd(r),i=new ci(n);return{combinedEnv:n,plasmoPublicEnv:i,loadedEnvFiles:r}}var Sc,vd,Ec,ci,Ed,li,fi=y(()=>{K();b();it();Sc="PLASMO_",vd="PLASMO_PUBLIC_",Ec=new Set,ci=class t{data;constructor(e){this.data=Object.keys(e).filter(r=>r.startsWith(vd)).reduce((r,n)=>(r[n]=e[n],r),{})}extends(e){T("Loaded environment variables from:",[...Ec]);let r=new t({...this.data});return r.data.NODE_ENV=process.env.NODE_ENV,Object.entries(e).forEach(([n,i])=>{r.data[`${Sc}${_d(n)}`]=i}),r}};Ed=/^\s*json\((.+)\)\s*$/si;li=()=>{let t=process.env.NODE_ENV,e=De();return[e.envPath,`.env.${e.browser}.local`,`.env.${e.tag}.local`,`.env.${t}.local`,t!=="test"?".env.local":"",`.env.${e.browser}`,`.env.${e.tag}`,`.env.${t}`,".env"].filter(r=>!!r)}});import{resolve as bd}from"path";async function kc({commonPath:t,publicEnv:e}){let r=Object.keys(e.data);r.length!==0&&await(0,bc.outputFile)(bd(t.dotPlasmoDirectory,kd),Cd(r))}var bc,ui,kd,Cd,pi=y(()=>{bc=A(z(),1),ui="process.env",kd=`${ui}.d.ts`,Cd=t=>`
declare namespace NodeJS {
  interface ProcessEnv {
${t.map(e=>`		${e}?: string`).join(`
`)}
  }
}
`});import Od from"typescript";var ye,zt,Cc=y(()=>{({SyntaxKind:ye}=Od),zt=t=>{switch(t.kind){case ye.StringLiteral:return t.text;case ye.TrueKeyword:return!0;case ye.FalseKeyword:return!1;case ye.NullKeyword:return null;case ye.NumericLiteral:return parseFloat(t.text);case ye.ArrayLiteralExpression:return t.elements.filter(e=>e.kind!==ye.SpreadElement).map(zt);case ye.ObjectLiteralExpression:return t.properties.filter(e=>e.kind===ye.PropertyAssignment&&(e.name.kind===ye.Identifier||e.name.kind===ye.StringLiteral)).map(e=>[e.name.escapedText||e.name.text,zt(e.initializer)]).reduce((e,[r,n])=>({...e,[r]:n}),{});default:return}}});import{readFile as Ld}from"fs/promises";import Nd from"typescript";var Md,Td,Id,Dd,Fd,Oc,Lc=y(()=>{b();Cc();({ScriptTarget:Md,SyntaxKind:Td,createSourceFile:Id,isObjectLiteralExpression:Dd,isVariableStatement:Fd}=Nd),Oc=async t=>{try{let e=await Ld(t,"utf8");if(e.length===0)return{isEmpty:!0};let n=Id(t,e,Md.Latest,!0).statements.filter(Fd).reduce((s,a)=>(a.declarationList.forEachChild(c=>{s[c.name.getText()]=c.initializer}),s),{}),i=n.config;if(!i||!Dd(i))return null;let o=i.properties.reduce((s,a)=>{if(a.getChildCount()<3)return s;let[c,f,l]=a.getChildren(),u=c.getText();try{l.kind===Td.Identifier?s[u]=zt(n[l.getText()]):s[u]=zt(l)}catch(p){fe(p)}return s},{});return m("Parsed config:",o),{config:o}}catch(e){return m(e),null}}});import{basename as Nc,resolve as mi}from"path";import Ar from"sharp";async function $r({assetsDirectory:t,genAssetsDirectory:e}){if(xt.baseIconPaths.length===0){let o=Mc();xt.baseIconPaths=o.map(s=>mi(t,s))}let r=await Le(xt.baseIconPaths,F);if(r===void 0){G("No icon found in assets directory");return}await(0,Yt.ensureDir)(e);let i=await Ar(r).toBuffer();m(`${r} found, creating resized icons`),await Promise.all($d.map(async o=>{if(xt.devProvidedIcons[o]===void 0){let c=Mc(di(o));xt.devProvidedIcons[o]=c.map(f=>mi(t,f))}let s=await Le(xt.devProvidedIcons[o],F),a=mi(e,`icon${o}.plasmo.png`);return process.env.NODE_ENV==="development"?s!==void 0?Nc(s).includes(".development.")?(0,Yt.copy)(s,a):Ar(s).grayscale().toFile(a):Ar(Buffer.from(i)).resize({width:o,height:o}).greyscale(!Nc(r).includes(".development.")).toFile(a):s!==void 0?(0,Yt.copy)(s,a):Ar(Buffer.from(i)).resize({width:o,height:o}).toFile(a)}))}var Yt,di,Ad,Mc,$d,xt,hi=y(()=>{Yt=A(z(),1);Jt();K();b();it();di=(t=512,e="icon")=>[`${e}${t}`,`${e}-${t}`,`${e}-${t}x${t}`],Ad=["icon",...di(),...di(1024)],Mc=(t=Ad)=>{let e=De();return t.map(r=>[`${r}.${e.tag}.${process.env.NODE_ENV}.png`,`${r}.${process.env.NODE_ENV}.png`,`${r}.${e.tag}.png`,`${r}.png`]).flat()},$d=[128,64,48,32,16],xt={baseIconPaths:[],devProvidedIcons:{}}});import{resolve as ne}from"path";var ie,Tc,gi=y(()=>{fi();ie=(t,e)=>t.reduce((r,n)=>(r[n]=e,r),{}),Tc=({sourceDirectory:t,packageFilePath:e,assetsDirectory:r},n,i)=>{let o=P=>[".ts",...i,".js"].flatMap(L=>[ne(t,`${P}.${n}${L}`),ne(t,`${P}.${process.env.NODE_ENV}${L}`),ne(t,`${P}${L}`)]),s=(P,L=[".ts",".js"])=>L.flatMap(N=>[ne(t,`${P}.${n}${N}`),ne(t,P,`index.${n}${N}`),ne(t,`${P}.${process.env.NODE_ENV}${N}`),ne(t,P,`index.${process.env.NODE_ENV}${N}`),ne(t,`${P}${N}`),ne(t,P,`index${N}`)]),a=s("popup",i),c=s("options",i),f=s("devtools",i),l=s("newtab",i),u=s("sidepanel",i),p=s("popup",[".html"]),d=s("options",[".html"]),h=s("devtools",[".html"]),g=s("newtab",[".html"]),_=s("sidepanel",[".html"]),S=li().map(P=>ne(t,P)),C=s("background"),O=o("content"),W=o("sandbox"),Me={[e]:2,...ie(S,1),...ie(O,7),...ie(W,19),...ie(C,5),...ie(a,15),...ie(c,17),...ie(f,13),...ie(l,9),...ie(u,11),...ie(p,16),...ie(d,18),...ie(h,14),...ie(g,10),...ie(_,12)},Pe=ne(t,"contents"),Je=ne(t,"sandboxes"),xe=ne(t,"tabs"),w=ne(t,"background"),k=[[20,Je],[4,xe],[8,Pe],[6,w],[3,r]],E=new Set(Object.keys(Me)),B=new Set([...C,...O,...W,...a,...c,...f,...l,...u]);return{popupIndexList:a,popupHtmlList:p,optionsIndexList:c,optionsHtmlList:d,devtoolsIndexList:f,devtoolsHtmlList:h,newtabIndexList:l,newtabHtmlList:g,backgroundIndexList:C,backgroundDirectory:w,contentIndexList:O,contentsDirectory:Pe,sidepanelIndexList:u,sidepanelHtmlList:_,sandboxIndexList:W,sandboxesDirectory:Je,tabsDirectory:xe,watchPathReasonMap:Me,watchDirectoryEntries:k,isEntryPath:P=>B.has(P),knownPathSet:E}}});import{resolve as Rd}from"path";var Ic,yi,Bd,Dc,Fc,_i=y(()=>{Ic=A(z(),1),yi="messaging",Bd=`${yi}.d.ts`,Dc=(t,e)=>(0,Ic.outputFile)(Rd(t.dotPlasmoDirectory,Bd),e),Fc=(t,e)=>`
import "@plasmohq/messaging"

interface MmMetadata {
	${t.join(`
	`)}
}

interface MpMetadata {
	${e.join(`
	`)}
}

declare module "@plasmohq/messaging" {
  interface MessagesMetadata extends MmMetadata {}
  interface PortsMetadata extends MpMetadata {}
}
`});import{readFile as jd}from"fs/promises";import{resolve as $c}from"path";import Ud from"json5";var Rr,Ac,qd,Wd,Rc,Bc=y(()=>{Rr=A(z(),1);_i();pi();Ac=".plasmo/index.d.ts",qd=[ui,yi].map(t=>`import "./${t}"`).join(`
`),Wd=async(t,e)=>{let r=$c(t.projectDirectory,"tsconfig.json"),n=await jd(r,"utf8"),i=Ud.parse(n),o=new Set(i.include);o.has(e)||(i.include=[e,...o],await(0,Rr.outputJson)(r,i,{spaces:2}))},Rc=async t=>{let e=$c(t.projectDirectory,Ac);await Promise.all([(0,Rr.outputFile)(e,qd),Wd(t,Ac)])}});import{lstat as Vd}from"fs/promises";import{resolve as Hd}from"path";async function jr({dotPlasmoDirectory:t,cacheDirectory:e}){await(0,Br.emptyDir)(t),await(0,Br.ensureDir)(e)}async function jc(t){let e=Hd(t.cacheDirectory,"parcel","data.mdb");if(!await F(e))return;let i=(await Vd(e,{bigint:!0})).size/1024n**2n,o=Number(i)/1024;o>1.47&&(m(`Busting large build cache, size: ${o.toFixed(2)} GB`),await jr(t))}var Br,wi=y(()=>{Br=A(z(),1);K();b()});import Gd from"package-json";import xi from"semver";async function Jd(t=""){switch((await st()).name){case"npm":return`"npm i -S plasmo@${t}"`;case"pnpm":return`"pnpm i plasmo@${t}"`;case"yarn":return`"yarn add plasmo@${t}"`}}var Ur,Uc,vt,Kt=y(()=>{Ur=A(z(),1);K();b();wi();sr();Uc=async t=>{let{plasmoVersionFilePath:e}=t;if(!await F(e))m("Plasmo version file not found, busting cache..."),await jr(t);else{let r=await(0,Ur.readJson)(e),n=xi.coerce(r.version),i=xi.coerce("0.86.2");(!n||n.major<i.major||n.major===i.major&&n.minor<i.minor)&&(m("Plasmo updated, busting cache..."),await jr(t))}await(0,Ur.writeJson)(e,{version:"0.86.2"})},vt=async()=>{let t="0.86.2";try{let r=(await Gd("plasmo",{version:"latest"})).version;if(xi.lt(t,r)){let{default:n}=await import("chalk");G(n.yellowBright(`A new version of plasmo is available: v${r}`));let i=await Jd(r);Ii(n.yellow(`Run ${i} to update`))}}catch(e){fe('Error fetching package information for "plasmo"',e)}}});var zd,qr,qc=y(()=>{b();zd=t=>T({target:t}),qr=(t,e=zd)=>{if(Array.isArray(t))return t.map(r=>qr(r,e)).filter(r=>r!==void 0);if(typeof t=="object"){let r={};for(let n in t)t.hasOwnProperty(n)&&(r[n]=qr(t[n],e),r[n]===void 0&&delete r[n]);return Object.keys(r).length===0?void 0:r}else return e(t)}});import{createHash as Yd}from"crypto";var Wr,vi=y(()=>{Wr=t=>Yd("md5").update(t).digest("hex").slice(0,18)});import{resolve as Hc}from"path";import{cwd as Kd}from"process";import Wc from"semver";var Gc,Xd,Qd,Zd,Jc,Vc,eh,zc,Yc,Si=y(()=>{Gc=A(z(),1);Ht();K();Ee();Xd=["react","svelte","vue","vanilla"],Qd=[".tsx",".svelte",".vue",".jsx"],Zd=new Set(Qd),Jc=t=>Zd.has(t),Vc="No supported UI library found.  You can file an RFC for a new UI Library here: https://github.com/PlasmoHQ/plasmo/issues",eh=async t=>{if(t.includes(":")){let[e,r]=t.split(":");switch(e){case"file":default:let n=await(0,Gc.readJson)(Hc(Kd(),r,"package.json"));return Wc.coerce(n.version)?.major}}else return Wc.coerce(t)?.major},zc=async t=>{let e=t.dependencies??{},r=Xd.find(s=>s in e);if(r===void 0)return{name:"vanilla",path:"vanilla",version:8427};let n=await eh(e[r]);if(n===void 0)throw new Error(Vc);if(r==="react"&&n<18)return{name:r,path:"react17",version:n};let i=`${r}${n}`,o=Hc(t.templatePath.staticTemplatePath,i);if(!await F(o))throw new Error(Vc);return{name:r,path:i,version:n}},Yc=t=>{switch(t){case"svelte":return{uiExts:[".svelte"],mountExt:".ts"};case"vue":return{uiExts:[".vue"],mountExt:".ts"};case"react":return{uiExts:[".tsx",".jsx"],mountExt:".tsx"};case"vanilla":return{uiExts:[".tsx",".jsx"],mountExt:".ts"};default:_t(t)}}});import{readFile as Kc,writeFile as th}from"fs/promises";import{join as Ei,relative as rh,resolve as _e}from"path";var St,Vr,Xc=y(()=>{St=A(z(),1);Jt();K();b();wt();vi();Ee();Si();Vr=class{constructor(e){this.plasmoManifest=e}#i={};#o={};get projectPath(){return this.plasmoManifest.projectPath}get commonPath(){return this.plasmoManifest.commonPath}get mountExt(){return this.plasmoManifest.mountExt}async init(){let[e,...r]=await Promise.all([this.#n(),this.#t("popup"),this.#t("options"),this.#t("newtab"),this.#t("devtools"),this.#t("sidepanel")]);return r}#n=async()=>{let e=_e(this.plasmoManifest.templatePath.staticTemplatePath,"common"),r=_e(this.commonPath.staticDirectory,"common");return(0,St.copy)(e,r)};#t=async e=>{m(`Creating static templates for ${e}`);let r=this.projectPath[`${e}IndexList`],n=this.projectPath[`${e}HtmlList`],[i,o]=await Promise.all([r,n].map(l=>Le(l,F))),{staticDirectory:s}=this.commonPath;await(0,St.ensureDir)(s);let a=i!==void 0,c=a?ce(rh(s,i)):`~${e}`,f=_e(s,`${e}${this.mountExt}`);return await Promise.all([this.#e(`index${this.mountExt}`,f,{__plasmo_import_module__:c}),this.createPageHtml(e,o)]),a};generateHtml=async(e="",r="",n="")=>{let i={__plasmo_static_index_title__:this.plasmoManifest.name,__plasmo_static_script__:r};return await ir(n)?this.#r(n,e,{...i,"</body>":`<div id="__plasmo"></div><script src="${r}" type="module"></script></body>`}):this.#e("index.html",e,i)};createPageHtml=async(e,r="")=>{let n=_e(this.commonPath.dotPlasmoDirectory,`${e}.html`),i=`./static/${e}${this.mountExt}`;return this.generateHtml(n,i,r)};createPageMount=async e=>{m(`Creating page mount template for ${e.dir}`);let r=_e(this.commonPath.dotPlasmoDirectory,e.dir),n=_e(r,`${e.name}.html`);await(0,St.ensureDir)(r);let i=Jc(e.ext),o=_e(r,`${e.name}${this.mountExt}`),s=_e(this.commonPath.sourceDirectory,e.dir,`${e.name}.html`),a=await Promise.all(i?[this.#e(`index${this.mountExt}`,o,{__plasmo_import_module__:`~${ce(Ei(e.dir,e.name))}`}),this.generateHtml(n,`./${e.name}${this.mountExt}`,s)]:[this.generateHtml(n,`~${ce(Ei(e.dir,e.name))}${e.ext}`,s)]);return{htmlPath:n,wereFilesWritten:a.some(c=>c)}};createContentScriptMount=async e=>{m(`Creating content script mount for ${e.dir}`);let r=_e(this.commonPath.staticDirectory,e.dir);await(0,St.ensureDir)(r);let n=_e(r,`${e.name}${this.mountExt}`);return await this.#e(`content-script-ui-mount${this.mountExt}`,n,{__plasmo_mount_content_script__:`~${ce(Ei(e.dir,e.name))}`}),n};#s=async(e,r,n)=>{let i=Object.entries(n).reduce((s,[a,c])=>s.replaceAll(a,c),e),o=Wr(Buffer.from(i));return this.#o[r]===o?!1:(this.#o[r]=o,await th(r,i),!0)};#r=async(e,r,n)=>{let i=await Kc(e,"utf8");return this.#s(i,r,n)};#e=async(e,r,n)=>(this.#i[e]||=await Kc(_e(this.plasmoManifest.staticScaffoldPath,e),"utf8"),this.#s(this.#i[e],r,n))}});import{ok as Ne}from"assert";import{readdir as Qc}from"fs/promises";import{basename as nh,dirname as ih,extname as Zc,isAbsolute as oh,join as sh,parse as el,relative as Hr,resolve as rt}from"path";import{cwd as ah}from"process";import ch from"fast-glob";import{hasher as lh}from"node-object-hash";var le,Xt,fh,uh,Et,Ee=y(()=>{le=A(z(),1);ri();Ht();on();K();b();wt();fi();pi();or();Lc();hi();gi();Nn();Bc();wi();Kt();qc();Xc();Si();Xt={16:"./gen-assets/icon16.plasmo.png",32:"./gen-assets/icon32.plasmo.png",48:"./gen-assets/icon48.plasmo.png",64:"./gen-assets/icon64.plasmo.png",128:"./gen-assets/icon128.plasmo.png"},fh=["storage"],uh=lh({trim:!0,sort:!0}),Et=class{constructor(e){this.bundleConfig=e;this.data.icons=Xt,this.scaffolder=new Vr(this)}get browser(){return this.bundleConfig.browser}#i;get commonPath(){return ni(this.#i)}#o;get projectPath(){return ni(this.#o)}templatePath=_r();#n;get combinedEnv(){return Ne(this.#n),this.#n.combinedEnv}get publicEnv(){return Ne(this.#n),this.#n.plasmoPublicEnv}#t=new Set([".ts",".js"]);#s=new Set;#r;get uiLibrary(){return Ne(this.#r),this.#r.uiLibrary}get mountExt(){return Ne(this.#r),this.#r.uiExtMap.mountExt}get uiExts(){return Ne(this.#r),this.#r.uiExtMap.uiExts}#e="";#a="";data={};overideManifest={};packageData;contentScriptMap=new Map;get mainWorldScriptList(){let e=[];for(let r of this.contentScriptMap.values())r.world==="MAIN"&&e.push(r);return e}get hasMainWorldScript(){for(let e of this.contentScriptMap.values())if(e.world==="MAIN")return!0;return!1}copyMap=new Map;permissionSet=new Set;scaffolder;get changed(){return this.#e!==this.#a}get name(){return Ne(this.packageData),this.packageData.displayName}get dependencies(){return Ne(this.packageData),this.packageData.dependencies??this.packageData.peerDependencies}get devDependencies(){return Ne(this.packageData),this.packageData.devDependencies}get staticScaffoldPath(){return Ne(this.uiLibrary),rt(this.templatePath.staticTemplatePath,this.uiLibrary.path)}async initEnv(e=ah()){this.#n=await Pc(e),this.#i=ot(e)}async startup(){await this.initEnv(),m(`Ensure exists: ${this.commonPath.dotPlasmoDirectory}`),await(0,le.ensureDir)(this.commonPath.dotPlasmoDirectory),await jc(this.commonPath),await Uc(this.commonPath),await $r(this.commonPath),await Rc(this.commonPath),await this.updateEnv(),await this.updatePackageData()}async postBuild(){await Promise.all(Array.from(this.copyMap,async([e,r])=>{await nr(e)||await(0,le.copy)(r,e)}))}async updateEnv(){await this.initEnv(this.commonPath.projectDirectory),await kc(this)}prefixDev=(e="")=>process.env.NODE_ENV==="development"?`DEV | ${e}`:e;async updatePackageData(){if(this.packageData=await(0,le.readJson)(this.commonPath.packageFilePath),!this.packageData)throw new Error("Invalid package.json");this.data.version=this.packageData.version,this.data.author=this.packageData.author,this.data.name=this.prefixDev(this.packageData.displayName),this.data.description=this.packageData.description,this.packageData.homepage&&(this.data.homepage_url=this.packageData.homepage);for(let e of fh)`@plasmohq/${e}`in(this.packageData.dependencies||{})&&this.permissionSet.add(e);await this.#c(),this.overideManifest=await this.#l()}#c=async()=>{let e=await zc(this),r=Yc(e.name);this.#r={uiLibrary:e,uiExtMap:r},this.#s=new Set(r.uiExts),this.uiExts.forEach(n=>{this.#t.add(n)}),this.#o=Tc(this.commonPath,this.browser,this.uiExts)};toggleOptions=(e=!1)=>(e?this.data.options_ui={page:"./options.html",open_in_tab:!0}:delete this.data.options_ui,this);toggleOverrides=(e,r=!1)=>(r?this.data.chrome_url_overrides={...this.data.chrome_url_overrides,[e]:`./${e}.html`}:delete this.data.chrome_url_overrides?.[e],this);toggleNewtab=(e=!1)=>this.toggleOverrides("newtab",e);toggleDevtools=(e=!1)=>(e?this.data.devtools_page="./devtools.html":delete this.data.devtools_page,this);isPathInvalid=e=>{if(e===void 0)return!0;let r=Zc(e);if(!this.#t.has(r))return!0;let n=vc(e);return!!(n.length>0&&n!==`.${this.browser}`||n.length===0&&(0,le.existsSync)(e.replace(r,`.${this.browser}${r}`)))};toggleContentScript=async(e,r=!1)=>{if(this.isPathInvalid(e))return!1;if(r){let n=await Oc(e);if(n?.isEmpty)return!1;m("Adding content script: ",e);let i=Hr(this.commonPath.dotPlasmoDirectory,e),o=Zc(i),s=this.#s.has(o);if(this.uiLibrary?.name!=="vanilla"&&s){let c=sh("lab",i).replace(/(^src)[\\/]/,""),f=el(c);i=Hr(this.commonPath.dotPlasmoDirectory,await this.scaffolder.createContentScriptMount(f))}n?.config?.css&&n.config.css.length>0&&(n.config.css=n.config.css.map(c=>Hr(this.commonPath.dotPlasmoDirectory,rt(ih(e),c))));let a=this.injectEnvToObj({matches:["<all_urls>"],js:[n?.config?.world==="MAIN"?i.split(o)[0]:i],...n?.config||{}});this.contentScriptMap.set(e,a)}else this.contentScriptMap.delete(e);return fc("cs_changed"),r};addDirectory=async(e,r,n)=>(0,le.existsSync)(e)?Qc(e,{withFileTypes:!0}).then(i=>Promise.all(i.filter(o=>o.isFile()&&n?n(o.name):!0).map(o=>rt(e,o.name)).map(o=>r(o,!0)))).then(i=>i.includes(!0)):!1;addContentScriptsIndexFiles=async()=>{let e=this.projectPath.contentsDirectory;if(!await ji(e))return!1;let r=[...this.#t].flatMap(n=>[`index${n}`,`index.${this.browser}${n}`]);return Qc(e,{withFileTypes:!0}).then(n=>Promise.all(n.filter(i=>i.isDirectory()).map(i=>rt(e,i.name)).map(i=>this.addDirectory(i,this.toggleContentScript,o=>r.includes(o))))).then(n=>n.includes(!0))};addContentScriptsDirectory=async(e=this.projectPath.contentsDirectory)=>Promise.all([this.addDirectory(e,this.toggleContentScript),this.addContentScriptsIndexFiles()]).then(r=>r.includes(!0));togglePage=async(e,r=!1)=>{if(this.isPathInvalid(e))return!1;if(r){let n=Hr(this.commonPath.sourceDirectory,e),i=el(n),{wereFilesWritten:o}=await this.scaffolder.createPageMount(i);o&&(this.#e="")}else this.#e="";return r};addPagesDirectory=async e=>this.addDirectory(e,this.togglePage);write=(e=!1)=>{this.#a=this.#e;let r=this.toJSON();if(this.#e=uh.hash(r),!(!this.changed&&!e))return m("Hash changed, updating manifest"),(0,le.writeJson)(this.commonPath.entryManifestPath,r,{spaces:2})};toJSON=()=>{let e={...this.data},{options_ui:r,permissions:n,content_scripts:i,background:o,...s}=this.overideManifest;return e.options_ui?.page&&(e.options_ui={...e.options_ui,...r}),e.permissions=[...new Set([...this.permissionSet,...n||[]])],e.permissions?.length===0&&delete e.permissions,this.bundleConfig.manifestVersion==="mv2"&&(e.background={...e.background,...o},Object.keys(e.background).length===0&&delete e.background,s.host_permissions?.length>0&&(e.permissions=[...e.permissions||[],...s.host_permissions])),e.content_scripts=[...Array.from(this.contentScriptMap.values()).filter(a=>a.world!=="MAIN"),...i||[]],e.content_scripts.length===0&&delete e.content_scripts,{...e,...s}};#l=async()=>{if(!this.packageData?.manifest)return{};let e=await this.prepareOverrideManifest();if((e.web_accessible_resources?.length||0)>0&&(e.web_accessible_resources=await this.resolveWAR(this.packageData.manifest.web_accessible_resources)),e.browser_specific_settings)switch(this.browser){case"edge":case"safari":e.browser_specific_settings={[this.browser]:e.browser_specific_settings[this.browser]};break;case"firefox":case"gecko":e.browser_specific_settings={gecko:e.browser_specific_settings.gecko};break;default:delete e.browser_specific_settings}return this.injectEnvToObj(e)};copyProjectFile=async e=>{try{if(e.startsWith("~"))return this.copyProjectFile(e.slice(1));if(e.includes("*")){let o=await ch(e,{cwd:this.commonPath.projectDirectory,onlyFiles:!0});return await Promise.all(o.map(this.copyProjectFile)),e}let r=oh(e)?e:rt(this.commonPath.projectDirectory,e);if(!(!this.projectPath.isEntryPath(r)&&await(0,le.pathExists)(r)))return e;let i=rt(this.commonPath.distDirectory,e);return this.copyMap.set(i,r),ce(e)}catch{return e}};copyNodeModuleFile=async e=>{try{let r=v.resolve(e,{paths:[this.commonPath.projectDirectory]}),n=nh(r),i=rt(this.commonPath.distDirectory,n);return this.copyMap.set(i,r),n}catch{return null}};injectEnvToObj=e=>qr(e,r=>typeof r!="string"?r:r.match(/^\$(\w+)$/)?this.combinedEnv[r.substring(1)]||void 0:Mi(r,this.combinedEnv))}});import{relative as ph,resolve as tl}from"path";var Gr,rl,nl=y(()=>{Gr=A(z(),1);b();wt();Ee();rl=async({indexFilePath:t="",withMessaging:e=!1,withMainWorldScript:r=!1},n)=>{m("Creating BGSW entry");let i=tl(n.commonPath.staticDirectory,"background"),o=tl(i,"index.ts"),s=ph(i,t),a=[e&&'import "./messaging"',t&&`import "${ce(s).slice(0,-3)}"`,r&&'import "./main-world-scripts"'].filter(Boolean).join(`
`);await(0,Gr.ensureDir)(i),await(0,Gr.outputFile)(o,a)}});import{relative as mh,resolve as dh}from"path";import{camelCase as il}from"change-case";var ol,sl,al=y(()=>{ol=A(z(),1);b();wt();Ee();sl=async t=>{try{let e=dh(t.commonPath.staticDirectory,"background","main-world-scripts.ts"),r=t.mainWorldScriptList.map(i=>{let o=i.js.map(l=>{let u=il(l),p=`url:${ce(mh(t.commonPath.entryManifestPath,l))}`;return{importName:u,importPath:p}}),s=o.map(l=>`import ${l.importName} from "${l.importPath}"`).join(`
`),a=o.map(l=>l.importName),c=Object.entries(i).reduce((l,[u,p])=>(u!=="js"&&(l[il(u)]=p),l),{id:a.join("-"),js:[]}),f=JSON.stringify(c).replace(/"js":\[\]/,`"js":[${a.map(l=>`${l}.split("/").pop().split("?")[0]`).join(",")}]`);return[s,f]});if(r.length===0)return!1;t.permissionSet.add("scripting");let n=`${r.map(([i])=>i).join(`
`)}
chrome.scripting.registerContentScripts([
  ${r.map(([,i])=>i).join(`,
  `)}
]).catch(_ => {})
`;return await(0,ol.outputFile)(e,n),!0}catch(e){return m(e.message),!1}}});import{join as hh,resolve as gh}from"path";import{camelCase as yh}from"change-case";import _h from"fast-glob";var fl,cl,wh,Pi,ll,xh,ul,pl=y(()=>{fl=A(z(),1);K();b();wt();_i();vi();Ee();cl={md5Hash:""},wh=(t,e,r,n)=>`// @ts-nocheck
globalThis.__plasmoInternalPortMap = new Map()

${t}

chrome.runtime.onMessageExternal.addListener((request, sender, sendResponse) => {
  switch (request?.name) {
    ${r}
    default:
      break
  }

  return true
})

chrome.runtime.onMessage.addListener((request, sender, sendResponse) => {
  switch (request.name) {
    ${e}
    default:
      break
  }

  return true
})

chrome.runtime.onConnect.addListener(function(port) {
  globalThis.__plasmoInternalPortMap.set(port.name, port)
  port.onMessage.addListener(function(request) {
    switch (port.name) {
      ${n}
      default:
        break
    }
  })
})

`,Pi=async(t,e)=>{let r=hh(t.projectPath.backgroundDirectory,e);return await rr(r)?(await _h("**/*.ts",{cwd:r,onlyFiles:!0})).map(i=>{let s=ce(i).slice(0,-3),a=`${e}/${s}`,c=yh(a);return{importName:c,name:s,declaration:`"${s}" : {}`,importCode:`import { default as ${c} } from "~background/${a}"`}}):[]},ll=(t,e)=>`case "${t}":
  ${e}({
    ...request,
    sender
  }, {
    send: (p) => sendResponse(p)
  })
  break`,xh=(t,e)=>`case "${t}":
  ${e}({
    port,
    ...request
  }, {
    send: (p) => port.postMessage(p)
  })
  break`,ul=async t=>{try{let e=await Promise.all([Pi(t,"messages"),Pi(t,"messages/external"),Pi(t,"ports")]),[r,n,i]=e;if(m({messageHandlerList:r,externalMessageHandlerList:n,portHandlerList:i}),e.every(c=>c.length===0))return!1;if(!("@plasmohq/messaging"in t.dependencies))return G("@plasmohq/messaging is not installed, skipping messaging API"),!1;let o=Fc(r.map(({declaration:c})=>c),i.map(({declaration:c})=>c)),s=Wr(Buffer.from(o));if(cl.md5Hash===s)return!0;cl.md5Hash=s;let a=wh([...r,...n,...i].map(c=>c.importCode).join(`
`),r.map(c=>ll(c.name,c.importName)).join(`
`),n.map(c=>ll(c.name,c.importName)).join(`
`),i.map(c=>xh(c.name,c.importName)).join(`
`));return await Promise.all([(0,fl.outputFile)(gh(t.commonPath.staticDirectory,"background","messaging.ts"),a),Dc(t.commonPath,o)]),!0}catch(e){return m(e.message),!1}}});var Qt,bi=y(()=>{Jt();K();nl();al();pl();Ee();Qt=async t=>{let[e,r,n]=await Promise.all([Le(t.projectPath.backgroundIndexList,F),ul(t),sl(t)]),i=!!e||r||n;return i&&await rl({indexFilePath:e,withMessaging:r,withMainWorldScript:n},t),t.toggleBackground(i)}});import{subscribe as vh}from"@parcel/watcher";var Sh,ml,Eh,dl=y(()=>{wc();Ht();pe();b();bi();Ee();hi();gi();Sh=["node_modules","build",".plasmo","coverage",".git"],ml=async t=>{if($("--impulse"))return null;let{default:e}=await import("is-path-inside"),{knownPathSet:r,watchPathReasonMap:n,watchDirectoryEntries:i}=t.projectPath;m("Watching the following files:",r);let o=s=>{if(r.has(s))return n[s];let a=i.find(([,c])=>e(s,c));return a?(r.add(s),n[s]=a[0]):0};return vh(t.commonPath.projectDirectory,async(s,a)=>{if(s)throw s;await Promise.all(a.map(({path:c,type:f})=>Eh(f,c,o(c),t))),await t.write()},{backend:_c,ignore:Sh})},Eh=async(t,e,r,n)=>{let i=t!=="delete";switch(r){case 0:return;case 1:{G("Environment file change detected, please restart the dev server."),await n.updateEnv();return}case 3:{T("Assets directory changed, update dynamic assets"),await $r(n.commonPath);return}case 2:{T("package.json changed, updating manifest overrides. You might need to restart the dev server."),await n.updatePackageData();return}case 6:case 5:{await Qt(n);return}case 7:case 8:{await n.toggleContentScript(e,i),n.hasMainWorldScript&&await Qt(n);return}case 19:case 20:case 4:{await n.togglePage(e,i);return}case 11:{n.toggleSidePanel(i);return}case 15:{n.togglePopup(i);return}case 17:{n.toggleOptions(i);return}case 13:{n.toggleDevtools(i);return}case 9:{n.toggleNewtab(i);return}case 16:{await n.scaffolder.createPageHtml("popup",i&&e);return}case 18:{await n.scaffolder.createPageHtml("options",i&&e);return}case 14:{await n.scaffolder.createPageHtml("devtools",i&&e);return}case 10:{await n.scaffolder.createPageHtml("newtab",i&&e);return}case 12:{await n.scaffolder.createPageHtml("sidepanel",i&&e);return}default:_t(r)}}});import{dirname as Ph,join as bh,resolve as kh}from"path";import Ch from"@parcel/fs";import Jr from"@parcel/package-manager";import{Parcel as Oh}from"@plasmohq/parcel-core";var we,Lh,zr,ki=y(()=>{we=A(z(),1);pe();b();sr();Lh={npm:Jr.Npm,yarn:Jr.Yarn,pnpm:Jr.Pnpm},zr=async({commonPath:t,bundleConfig:e,publicEnv:r},{defaultTargetOptions:n={},...i})=>{let o=i.mode==="production";o?await(0,we.emptyDir)(t.distDirectory):await(0,we.ensureDir)(t.distDirectory),process.env.__PLASMO_FRAMEWORK_INTERNAL_NO_MINIFY=o&&$("--no-minify")?"true":"false",process.env.__PLASMO_FRAMEWORK_INTERNAL_SOURCE_MAPS=o?$("--inline-source-maps")?"inline":$("--source-maps")?"external":"none":$("--no-source-maps")?"none":"inline",process.env.__PLASMO_FRAMEWORK_INTERNAL_NO_CS_RELOAD=$("--no-cs-reload")?"true":"false",process.env.__PLASMO_FRAMEWORK_INTERNAL_ES_TARGET=H("--es-target")||"es2022";let s=await st(),a=new Ch.NodeFS,c=Lh[s.name],f=new Jr.NodePackageManager(a,t.projectDirectory,new c),l=v.resolve("@plasmohq/parcel-config"),u=bh(Ph(l),"run.json"),p=await(0,we.readJson)(l);$("--bundle-buddy")&&(p.reporters=["...","@parcel/reporter-bundle-buddy"]),await(0,we.writeJson)(u,p),await(0,we.exists)(t.parcelConfig)&&(u=t.parcelConfig,o&&(await(0,we.readJson)(u)).extends!=="@plasmohq/parcel-config"&&G('The .parcelrc does not extend "@plasmohq/parcel-config", the result may be unexpected'),$("--bundle-buddy")&&G('The "--bundle-buddy" flag does not work with a custom .parcelrc file'));let d={browsers:e.manifestVersion==="mv2"&&e.browser!=="firefox"?["IE 11"]:["last 1 Chrome version"]};return new Oh({inputFS:a,packageManager:f,entries:t.entryManifestPath,cacheDir:kh(t.cacheDirectory,"parcel"),config:u,shouldAutoInstall:!0,env:r.extends(e).data,defaultTargetOptions:{...n,engines:d,sourceMaps:process.env.__PLASMO_FRAMEWORK_INTERNAL_SOURCE_MAPS!=="none",distDir:t.distDirectory},...i})}});var Yr,hl=y(()=>{b();Ee();Yr=class extends Et{constructor(e){super(e),this.data.manifest_version=2,this.data.browser_action={default_icon:Xt}}toggleSidePanel=(e=!1)=>{switch(this.browser){case"firefox":case"gecko":{e?this.data.sidebar_action={default_panel:"./sidepanel.html"}:delete this.data.sidebar_action;break}default:T("SidePanel is not available on chromium-based MV2 browsers, skipping.")}return this};togglePopup=(e=!1)=>(e?this.data.browser_action.default_popup="./popup.html":delete this.data.browser_action.default_popup,this);toggleBackground=(e=!1)=>(e?this.data.background={scripts:["./static/background/index.ts"]}:delete this.data.background,e);prepareOverrideManifest=()=>{let{manifest:e}=this.packageData,r={...e};return r.permissions=[...e.permissions||[],...e.host_permissions||[]],"host_permissions"in r&&delete r.host_permissions,"content_security_policy"in e&&(r.content_security_policy=e.content_security_policy?.extension_pages),r};resolveWAR=e=>Promise.all(e.map(async({resources:r})=>(await Promise.all(r.map(async i=>await this.copyNodeModuleFile(i)||await this.copyProjectFile(i)))).flat())).then(r=>r.flat())}});var Kr,gl=y(()=>{Ee();Kr=class extends Et{constructor(e){super(e),this.data.manifest_version=3,this.data.action={default_icon:Xt}}toggleSidePanel=(e=!1)=>{switch(this.browser){case"firefox":case"gecko":{e?this.data.sidebar_action={default_panel:"./sidepanel.html"}:delete this.data.sidebar_action;break}default:e?(this.data.side_panel={default_path:"./sidepanel.html"},this.permissionSet.add("sidePanel")):(delete this.data.side_panel,this.permissionSet.delete("sidePanel"))}return this};togglePopup=(e=!1)=>(e?this.data.action.default_popup="./popup.html":delete this.data.action.default_popup,this);toggleBackground=(e=!1)=>(e?this.data.background={service_worker:"./static/background/index.ts"}:delete this.data.background,e);prepareOverrideManifest=()=>({...this.packageData.manifest});resolveWAR=e=>Promise.all(e.map(async({resources:r,...n})=>({resources:(await Promise.all(r.map(async o=>await this.copyNodeModuleFile(o)||await this.copyProjectFile(o)))).flat(),...n})))}});async function Pt(t){m("Creating Manifest Factory...");let e=t.manifestVersion==="mv3"?new Kr(t):new Yr(t);await e.startup();let{contentIndexList:r,sandboxIndexList:n,tabsDirectory:i,sandboxesDirectory:o}=e.projectPath,[s,a]=await Promise.all([r,n].map(g=>Le(g,F))),c=await Promise.all([e.scaffolder.init(),e.togglePage(a,!0),e.toggleContentScript(s,!0),e.addContentScriptsDirectory(),e.addPagesDirectory(i),e.addPagesDirectory(o)]);c.push(await Qt(e));let f=c.flat();f.includes(!0)||G("Unable to find any entry files. The extension might be empty");let[l,u,p,d,h]=f;return e.togglePopup(l).toggleOptions(u).toggleNewtab(p).toggleDevtools(d).toggleSidePanel(h),await e.write(!0),e}var Xr=y(()=>{Jt();K();b();bi();hl();gl()});var yl={};ze(yl,{default:()=>Mh});async function Nh(){ue(),await vt(),process.env.NODE_ENV="development";let t=H("--serve-port")||"1012",e=H("--serve-host")||"localhost",r=H("--hmr-port")||"1815",n=H("--hmr-host")||"localhost";T("Starting the extension development server...");let{default:i}=await import("get-port"),[o,s]=await Promise.all([i({port:parseInt(t)}),i({port:parseInt(r)})]),a=ti(n,s);m(`Starting dev server on ${e}:${o}, HMR on ${n}:${s}...`);let c=yt(),f=await Pt(c),l=await ml(f),u=await zr(f,{logLevel:"verbose",shouldBundleIncrementally:!0,serveOptions:{host:e,port:o},hmrOptions:{host:n,port:s}}),{default:p}=await import("chalk"),d=await u.watch(async(g,_)=>{if(g)throw g;_!==void 0&&(_.type==="buildSuccess"?(Ie(`Extension re-packaged in ${p.bold(_.buildTime)}ms! \u{1F680}`),await f.postBuild(),a.broadcast("build_ready")):_.type==="buildFailure"&&(bt()||fe(p.redBright(`Build failed. To debug, run ${p.bold("plasmo dev --verbose")}.`)),_.diagnostics.forEach(S=>{fe(p.redBright(S.message)),S.stack&&m(S.stack),S.hints?.forEach(C=>{m(C)}),S.codeFrames?.forEach(C=>{C.code&&m(C.code),C.codeHighlights.forEach(O=>{O.message&&m(O.message),m(p.underline(`${C.filePath}:${O.start.line}:${O.start.column}`))})})})),process.env.__PLASMO_FRAMEWORK_INTERNAL_WATCHER_STARTED="true")}),h=()=>{l?.unsubscribe(),d.unsubscribe()};process.on("SIGINT",h),process.on("SIGTERM",h)}var Mh,_l=y(()=>{ri();pe();b();Ir();dl();Kt();ki();Ye();Xr();Mh=Nh});import{readdir as Th,readFile as Ih,rename as wl,stat as Dh,writeFile as Fh}from"fs/promises";import{join as Ah,resolve as $h}from"path";var Rh,Ci,xl=y(()=>{Rh=async t=>{let r=(await Ih($h(t),"utf8")).replace(/\/_/g,"/");await Fh(t,r,"utf8")},Ci=async(t="")=>{let e=await Th(t);for(let r of e){let n=Ah(t,r);if((await Dh(n)).isDirectory()){let o=n.replace("/_","/");await wl(n,o),await Ci(o)}else{let o=n.replace("/_","/");await wl(n,o),await Rh(o)}}}});import{mkdir as Bh}from"fs/promises";import{resolve as Oi}from"path";import{sentenceCase as jh}from"change-case";var Ge,Uh,vl,Sl=y(()=>{Ge=A(z(),1);K();b();or();xl();Uh=t=>({name:jh(t.name),description:t.description,version:t.version,manifest_version:3,chrome_url_overrides:{newtab:"./index.html"}}),vl=async()=>{let{projectDirectory:t,packageFilePath:e}=ot();m("Creating a Plasmo + Nextjs based new tab extension");let r=Oi(t,"out"),{default:n}=await import("chalk");if(!await F(r))throw new Error(`${n.bold("out")} directory does not exist, did you forget to run "${n.underline("next build && next export")}"?`);let i=await(0,Ge.readJson)(e),o=Oi(t,"extension");if(await F(o)){let{default:{prompt:s}}=await import("inquirer"),{answer:a}=await s({type:"confirm",name:"answer",message:`${n.bold("extension")} directory already exists, do you want to overwrite it?`});if(!a)throw new Error("Aborted");await(0,Ge.emptyDir)(o)}await Bh(o),await(0,Ge.copy)(r,o),m("Extension created at:",o),await Ci(o),await(0,Ge.writeJson)(Oi(o,"manifest.json"),Uh(i),{spaces:2}),Ie("Your extension is ready in the extension/ directory")}});import{createReadStream as qh,createWriteStream as Wh}from"fs";import{resolve as El}from"path";import Vh from"fast-glob";import{AsyncZipDeflate as Hh,Zip as Gh}from"fflate";function Jh(t){return t/1024/1024}var Qr,Li=y(()=>{b();Qr=async({distDirectory:t,buildDirectory:e,distDirectoryName:r},n=!1)=>{let i=El(e,`${r}.zip`),o=Wh(i),s=await Vh(["**/*",!n&&"!**/(*.js.map|*.css.map)"].filter(Boolean),{cwd:t,onlyFiles:!0});return new Promise((a,c)=>{let f=0,l=!1,u=Date.now(),p=new Gh((d,h,g)=>{l||(d?c(d):(f+=h.length,o.write(h),g&&(T(`Zip Package size: ${Jh(f).toFixed(2)} MB in ${Date.now()-u}ms`),o.end(),a())))});for(let d of s){if(l)return;let h=new Hh(d,{level:9});p.add(h);let g=El(t,d);qh(g).on("data",_=>{h.push(_,!1)}).on("end",()=>{h.push(new Uint8Array(0),!0)}).on("error",_=>{l=!0,p.terminate(),c(`Error reading file ${g}: ${_.message}`)})}p.end()})}});var Pl={};ze(Pl,{default:()=>Yh});async function zh(){ue(),await vt(),process.env.NODE_ENV="production";let[t]=Zt("build");if(t==="next-new-tab"){await vl();return}T("Prepare to bundle the extension...");let e=yt(),r=await Pt(e),i=await(await zr(r,{mode:"production",shouldDisableCache:!0,shouldContentHash:!1,defaultTargetOptions:{shouldOptimize:!0,shouldScopeHoist:$("--hoist")}})).run();Ie(`Finished in ${i.buildTime}ms!`),await r.postBuild(),$("--zip")&&await Qr(r.commonPath)}var Yh,bl=y(()=>{er();pe();b();Ir();Sl();Kt();ki();Ye();Xr();Li();Yh=zh});var kl={};ze(kl,{default:()=>Xh});async function Kh(){ue(),await vt(),process.env.NODE_ENV="production",T("Prepare to package the extension bundle...");let t=yt(),e=await Pt(t);await Qr(e.commonPath,$("--with-source-maps"))}var Xh,Cl=y(()=>{pe();b();Ir();Kt();Ye();Xr();Li();Xh=Kh});var Zr={};ze(Zr,{default:()=>Zh});async function Qh(){console.log("0.86.2")}var Zh,en=y(()=>{Zh=Qh});var tn,sn,Ol,an=y(()=>{tn={help:()=>Promise.resolve().then(()=>(Ai(),Fi)),start:()=>Promise.resolve().then(()=>(Ri(),$i)),init:()=>Promise.resolve().then(()=>(ia(),na)),dev:()=>Promise.resolve().then(()=>(_l(),yl)),build:()=>Promise.resolve().then(()=>(bl(),Pl)),package:()=>Promise.resolve().then(()=>(Cl(),kl)),version:()=>Promise.resolve().then(()=>(en(),Zr)),"-v":()=>Promise.resolve().then(()=>(en(),Zr)),"--version":()=>Promise.resolve().then(()=>(en(),Zr))},sn=Object.keys(tn),Ol=new Set(sn)});import{argv as Ll,exit as Ni,versions as eg}from"process";import tg from"semver";pe();b();an();Ye();async function rg(){ue(),tr()}async function ng(){try{if(Ll.length>10)throw new Error("Too many arguments provided.");if(tg.major(eg.node)<16)throw new Error("Node version must be >= 16");process.env.VERBOSE=Ti?"true":"false";let t=Ll.find(e=>Ol.has(e));if(t in tn){m("Running command:",t);let{default:e}=await tn[t]();await e()}else m("Running default mode"),await rg()}catch(t){fe(t?.message||"Unknown error."),m(t?.stack),Ni(1)}}ng();process.on("SIGINT",()=>Ni(0));process.on("SIGTERM",()=>Ni(0));
